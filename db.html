<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html"><link rel="search" title="Search" href="search.html"><link rel="next" title="Filesystems" href="filesystems.html"><link rel="prev" title="Configuration" href="config.html">
        <link rel="prefetch" href="_static/redun.svg" as="image">

    <link rel="shortcut icon" href="_static/redun-no-text.svg"><!-- Generated with Sphinx 8.1.3 and Furo 2025.09.25 -->
        <title>Backend and database - redun documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=580074bf" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">redun  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="_static/redun.svg" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">redun  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">User guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="design.html">Design overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="values.html">Values</a></li>
<li class="toctree-l1"><a class="reference internal" href="tasks.html">Tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="executors.html">Executors</a></li>
<li class="toctree-l1"><a class="reference internal" href="scheduler.html">Scheduling redun workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configuration</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Backend and database</a></li>
<li class="toctree-l1"><a class="reference internal" href="filesystems.html">Filesystems</a></li>
<li class="toctree-l1"><a class="reference internal" href="tags.html">Tags</a></li>
<li class="toctree-l1"><a class="reference internal" href="spark.html">Spark</a></li>
<li class="toctree-l1"><a class="reference internal" href="typing.html">Type checking</a></li>
<li class="toctree-l1"><a class="reference internal" href="console.html">Console (TUI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="context.html">Context</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html">Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="FAQ.html">FAQ</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="developing.html">Developer guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="CHANGELOG.html">Changelog</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Implementation notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="implementation/evaluation.html">Computational model</a></li>
<li class="toctree-l1"><a class="reference internal" href="implementation/graph_reduction_caching.html">Graph reduction caching</a></li>
<li class="toctree-l1"><a class="reference internal" href="implementation/hashing.html">Content addressable hashing summary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="redun/modules.html">API docs</a><input aria-label="Toggle navigation of API docs" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="redun/redun.html">redun package</a><input aria-label="Toggle navigation of redun package" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="redun/redun.backends.html">redun.backends package</a><input aria-label="Toggle navigation of redun.backends package" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="redun/redun.backends.db.html">redun.backends.db package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="redun/redun.console.html">redun.console package</a></li>
<li class="toctree-l3"><a class="reference internal" href="redun/redun.executors.html">redun.executors package</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/insitro/redun">GitHub repository</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/db.md.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="backend-and-database">
<h1>Backend and database<a class="headerlink" href="#backend-and-database" title="Link to this heading">¶</a></h1>
<p>redun stores data provenance and cached values in <em>repositories</em>, (repos for short), similar to how <a class="reference external" href="https://git-scm.com/book/en/v2/Git-Basics-Getting-a-Git-Repository">git stores commit graphs in repos</a>.
redun repos are currently implemented using either sqlite (the default) or PostgreSQL.
Additionally, users may specify an <a class="reference internal" href="#optional-value-store">external key-value store</a> to avoid bloating the primary repo with large binary objects.</p>
<p>Once your workflows mature to the point where you want to share them or their results with collaborators, we recommend configuring a persistent database repo for provenance tracking.
See the <a class="reference internal" href="config.html#backend"><span class="std std-ref">backend configuration</span></a> section for details.</p>
<section id="querying-call-graphs">
<h2>Querying call graphs<a class="headerlink" href="#querying-call-graphs" title="Link to this heading">¶</a></h2>
<p>Every time redun executes a workflow, it records the execution as a CallGraph. The <code class="docutils literal notranslate"><span class="pre">redun</span> <span class="pre">log</span></code> command can be used to query past executions and walk through the CallGraph (see also the <a class="reference internal" href="console.html"><span class="std std-doc">Console (TUI)</span></a>). Here we’ll walk through the <code class="docutils literal notranslate"><span class="pre">examples/compile/</span></code> example. The workflow script should look something like this:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">redun</span><span class="w"> </span><span class="kn">import</span> <span class="n">task</span><span class="p">,</span> <span class="n">File</span>


<span class="nd">@task</span><span class="p">()</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compile</span><span class="p">(</span><span class="n">c_file</span><span class="p">:</span> <span class="n">File</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compile one C file into an object file.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;gcc -c </span><span class="si">{c_file}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">c_file</span><span class="o">=</span><span class="n">c_file</span><span class="o">.</span><span class="n">path</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">File</span><span class="p">(</span><span class="n">c_file</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.c&#39;</span><span class="p">,</span> <span class="s1">&#39;.o&#39;</span><span class="p">))</span>


<span class="nd">@task</span><span class="p">()</span>
<span class="k">def</span><span class="w"> </span><span class="nf">link</span><span class="p">(</span><span class="n">prog_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">o_files</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">File</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Link several object files together into one program.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;gcc -o </span><span class="si">{prog_path}</span><span class="s2"> </span><span class="si">{o_files}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">prog_path</span><span class="o">=</span><span class="n">prog_path</span><span class="p">,</span>
        <span class="n">o_files</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">o_file</span><span class="o">.</span><span class="n">path</span> <span class="k">for</span> <span class="n">o_file</span> <span class="ow">in</span> <span class="n">o_files</span><span class="p">),</span>
    <span class="p">))</span>
    <span class="k">return</span> <span class="n">File</span><span class="p">(</span><span class="n">prog_path</span><span class="p">)</span>


<span class="nd">@task</span><span class="p">()</span>
<span class="k">def</span><span class="w"> </span><span class="nf">make_prog</span><span class="p">(</span><span class="n">prog_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">c_files</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">File</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compile one program from its source C files.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">o_files</span> <span class="o">=</span> <span class="p">[</span>
        <span class="nb">compile</span><span class="p">(</span><span class="n">c_file</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">c_file</span> <span class="ow">in</span> <span class="n">c_files</span>
    <span class="p">]</span>
    <span class="n">prog_file</span> <span class="o">=</span> <span class="n">link</span><span class="p">(</span><span class="n">prog_path</span><span class="p">,</span> <span class="n">o_files</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">prog_file</span>


<span class="c1"># Definition of programs and their source C files.</span>
<span class="n">files</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;prog&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">File</span><span class="p">(</span><span class="s1">&#39;prog.c&#39;</span><span class="p">),</span>
        <span class="n">File</span><span class="p">(</span><span class="s1">&#39;lib.c&#39;</span><span class="p">),</span>
    <span class="p">],</span>
    <span class="s1">&#39;prog2&#39;</span><span class="p">:</span> <span class="p">[</span>
        <span class="n">File</span><span class="p">(</span><span class="s1">&#39;prog2.c&#39;</span><span class="p">),</span>
        <span class="n">File</span><span class="p">(</span><span class="s1">&#39;lib.c&#39;</span><span class="p">),</span>
    <span class="p">],</span>
<span class="p">}</span>


<span class="nd">@task</span><span class="p">()</span>
<span class="k">def</span><span class="w"> </span><span class="nf">make</span><span class="p">(</span><span class="n">files</span> <span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">List</span><span class="p">[</span><span class="n">File</span><span class="p">]]</span><span class="o">=</span><span class="n">files</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Top-level task for compiling all the programs in the project.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">progs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">make_prog</span><span class="p">(</span><span class="n">prog_path</span><span class="p">,</span> <span class="n">c_files</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">prog_path</span><span class="p">,</span> <span class="n">c_files</span> <span class="ow">in</span> <span class="n">files</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="n">progs</span>
</pre></div>
</div>
<p>For reference, these source files have the following contents:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="c1">// lib.c</span>
<span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="nf">get_message</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;Hello, World!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>


<span class="c1">// prog.c</span>
<span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="nf">get_message</span><span class="p">();</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="o">**</span><span class="w"> </span><span class="n">argv</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_message</span><span class="p">();</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;prog1: %s&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="p">);</span>
<span class="p">}</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>


<span class="c1">// prog2.c</span>
<span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="nf">get_message</span><span class="p">();</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="o">**</span><span class="w"> </span><span class="n">argv</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">msg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">get_message</span><span class="p">();</span>
<span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;prog2: %s&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">msg</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Let’s execute this workflow using <code class="docutils literal notranslate"><span class="pre">redun</span> <span class="pre">run</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">redun</span> <span class="n">run</span> <span class="n">make</span><span class="o">.</span><span class="n">py</span> <span class="n">make</span>

<span class="p">[</span><span class="n">redun</span><span class="p">]</span> <span class="n">Check</span> <span class="n">cache</span> <span class="n">make</span> <span class="p">(</span><span class="n">eval_hash</span><span class="o">=</span><span class="n">fe2a2a7d</span><span class="p">)</span><span class="o">...</span>
<span class="p">[</span><span class="n">redun</span><span class="p">]</span> <span class="n">Run</span> <span class="n">make</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;files&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;prog&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">prog</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="mi">574</span><span class="n">d39e642f407119c2661559cea39d491bd3dc1</span><span class="p">),</span> <span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">lib</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="n">a08d53bbaf62e480408552a2d3680e604f4cff50</span><span class="p">)],</span> <span class="s1">&#39;prog2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">prog2</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="n">b262cdb5130</span><span class="o">...</span><span class="p">)</span> <span class="n">on</span> <span class="n">default</span>
<span class="p">[</span><span class="n">redun</span><span class="p">]</span> <span class="n">Check</span> <span class="n">cache</span> <span class="n">make_prog</span> <span class="p">(</span><span class="n">eval_hash</span><span class="o">=</span><span class="n">e69b7ae9</span><span class="p">)</span><span class="o">...</span>
<span class="p">[</span><span class="n">redun</span><span class="p">]</span> <span class="n">Run</span> <span class="n">make_prog</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;prog&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">prog</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="mi">574</span><span class="n">d39e642f407119c2661559cea39d491bd3dc1</span><span class="p">),</span> <span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">lib</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="n">a08d53bbaf62e480408552a2d3680e604f4cff50</span><span class="p">)]),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{})</span> <span class="n">on</span> <span class="n">default</span>
<span class="p">[</span><span class="n">redun</span><span class="p">]</span> <span class="n">Check</span> <span class="n">cache</span> <span class="n">make_prog</span> <span class="p">(</span><span class="n">eval_hash</span><span class="o">=</span><span class="mi">045</span><span class="n">f3cca</span><span class="p">)</span><span class="o">...</span>
<span class="p">[</span><span class="n">redun</span><span class="p">]</span> <span class="n">Run</span> <span class="n">make_prog</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;prog2&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">prog2</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="n">b262cdb5130e8984ed3bb0dba8c83e56173ed702</span><span class="p">),</span> <span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">lib</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="n">a08d53bbaf62e480408552a2d3680e604f4cff50</span><span class="p">)]),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{})</span> <span class="n">on</span> <span class="n">default</span>
<span class="p">[</span><span class="n">redun</span><span class="p">]</span> <span class="n">Check</span> <span class="n">cache</span> <span class="nb">compile</span> <span class="p">(</span><span class="n">eval_hash</span><span class="o">=</span><span class="mi">2872</span><span class="n">aec1</span><span class="p">)</span><span class="o">...</span>
<span class="p">[</span><span class="n">redun</span><span class="p">]</span> <span class="n">Run</span> <span class="nb">compile</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">prog</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="mi">574</span><span class="n">d39e642f407119c2661559cea39d491bd3dc1</span><span class="p">),),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{})</span> <span class="n">on</span> <span class="n">default</span>
<span class="p">[</span><span class="n">redun</span><span class="p">]</span> <span class="n">Check</span> <span class="n">cache</span> <span class="nb">compile</span> <span class="p">(</span><span class="n">eval_hash</span><span class="o">=</span><span class="mi">600</span><span class="n">f6efe</span><span class="p">)</span><span class="o">...</span>
<span class="p">[</span><span class="n">redun</span><span class="p">]</span> <span class="n">Run</span> <span class="nb">compile</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">lib</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="n">a08d53bbaf62e480408552a2d3680e604f4cff50</span><span class="p">),),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{})</span> <span class="n">on</span> <span class="n">default</span>
<span class="p">[</span><span class="n">redun</span><span class="p">]</span> <span class="n">Check</span> <span class="n">cache</span> <span class="nb">compile</span> <span class="p">(</span><span class="n">eval_hash</span><span class="o">=</span><span class="n">ee7f4a1a</span><span class="p">)</span><span class="o">...</span>
<span class="p">[</span><span class="n">redun</span><span class="p">]</span> <span class="n">Run</span> <span class="nb">compile</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">prog2</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="n">b262cdb5130e8984ed3bb0dba8c83e56173ed702</span><span class="p">),),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{})</span> <span class="n">on</span> <span class="n">default</span>
<span class="p">[</span><span class="n">redun</span><span class="p">]</span> <span class="n">Check</span> <span class="n">cache</span> <span class="n">link</span> <span class="p">(</span><span class="n">eval_hash</span><span class="o">=</span><span class="mi">7</span><span class="n">d623fd2</span><span class="p">)</span><span class="o">...</span>
<span class="p">[</span><span class="n">redun</span><span class="p">]</span> <span class="n">Run</span> <span class="n">link</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;prog&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">prog</span><span class="o">.</span><span class="n">o</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="n">ea439e92541937ec0777210367ed8a05ec91dad0</span><span class="p">),</span> <span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">lib</span><span class="o">.</span><span class="n">o</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="n">ecf0db54c26fd406610d140494ba580740c610e2</span><span class="p">)]),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{})</span> <span class="n">on</span> <span class="n">default</span>
<span class="p">[</span><span class="n">redun</span><span class="p">]</span> <span class="n">Check</span> <span class="n">cache</span> <span class="n">link</span> <span class="p">(</span><span class="n">eval_hash</span><span class="o">=</span><span class="n">af9f2dad</span><span class="p">)</span><span class="o">...</span>
<span class="p">[</span><span class="n">redun</span><span class="p">]</span> <span class="n">Run</span> <span class="n">link</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;prog2&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">prog2</span><span class="o">.</span><span class="n">o</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="mf">60e8</span><span class="n">a5e97fe8b6064d0655c1eee16ff6dd650946</span><span class="p">),</span> <span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">lib</span><span class="o">.</span><span class="n">o</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="n">ecf0db54c26fd406610d140494ba580740c610e2</span><span class="p">)]),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{})</span> <span class="n">on</span> <span class="n">default</span>
<span class="p">[</span><span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">prog</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="n">ff7aea3193ee882d1dc69f284d18d3353c97bc11</span><span class="p">),</span>
 <span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">prog2</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="n">e0e9a6701a1cef13d13df62ca492472016e5edc4</span><span class="p">)]</span>
</pre></div>
</div>
<p>This workflow should have compiled and linked two binaries <code class="docutils literal notranslate"><span class="pre">prog</span></code> and <code class="docutils literal notranslate"><span class="pre">prog2</span></code> (Note, you will need gcc installed for this example to work). We should now be able to execute one of the binaries:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>./prog

prog1: Hello, World!
</pre></div>
</div>
<p>Now, let’s edit one of the C files to have more exclamation marks!!!!!!</p>
<div class="highlight-diff notranslate"><div class="highlight"><pre><span></span><span class="gd">--- a/examples/compile/lib.c</span>
<span class="gi">+++ b/examples/compile/lib.c</span>
<span class="gu">@@ -1,3 +1,3 @@</span>
<span class="w"> </span>char *get_message() {
<span class="gd">-    return &quot;Hello, World!\n&quot;;</span>
<span class="gi">+    return &quot;Hello, World!!!!!!!!\n&quot;;</span>
<span class="w"> </span>}
</pre></div>
</div>
<p>We rerun our workflow and redun will automatically detect that some (but not all) of the tasks need to re-execute because an input file (lib.c) has changed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">redun</span> <span class="n">run</span> <span class="n">make</span><span class="o">.</span><span class="n">py</span> <span class="n">make</span>

<span class="p">[</span><span class="n">redun</span><span class="p">]</span> <span class="n">Check</span> <span class="n">cache</span> <span class="n">make</span> <span class="p">(</span><span class="n">eval_hash</span><span class="o">=</span><span class="mi">3</span><span class="n">bd939d5</span><span class="p">)</span><span class="o">...</span>
<span class="p">[</span><span class="n">redun</span><span class="p">]</span> <span class="n">Run</span> <span class="n">make</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="p">(),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;files&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;prog&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">prog</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="mi">574</span><span class="n">d39e642f407119c2661559cea39d491bd3dc1</span><span class="p">),</span> <span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">lib</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="n">e8ff8720b689411145e97dec7d0f8ad9b4ee4e38</span><span class="p">)],</span> <span class="s1">&#39;prog2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">prog2</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="n">b262cdb5130</span><span class="o">...</span><span class="p">)</span> <span class="n">on</span> <span class="n">default</span>
<span class="p">[</span><span class="n">redun</span><span class="p">]</span> <span class="n">Check</span> <span class="n">cache</span> <span class="n">make_prog</span> <span class="p">(</span><span class="n">eval_hash</span><span class="o">=</span><span class="n">a925dcaa</span><span class="p">)</span><span class="o">...</span>
<span class="p">[</span><span class="n">redun</span><span class="p">]</span> <span class="n">Run</span> <span class="n">make_prog</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;prog&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">prog</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="mi">574</span><span class="n">d39e642f407119c2661559cea39d491bd3dc1</span><span class="p">),</span> <span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">lib</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="n">e8ff8720b689411145e97dec7d0f8ad9b4ee4e38</span><span class="p">)]),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{})</span> <span class="n">on</span> <span class="n">default</span>
<span class="p">[</span><span class="n">redun</span><span class="p">]</span> <span class="n">Check</span> <span class="n">cache</span> <span class="n">make_prog</span> <span class="p">(</span><span class="n">eval_hash</span><span class="o">=</span><span class="mi">8</span><span class="n">f6b3814</span><span class="p">)</span><span class="o">...</span>
<span class="p">[</span><span class="n">redun</span><span class="p">]</span> <span class="n">Run</span> <span class="n">make_prog</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;prog2&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">prog2</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="n">b262cdb5130e8984ed3bb0dba8c83e56173ed702</span><span class="p">),</span> <span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">lib</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="n">e8ff8720b689411145e97dec7d0f8ad9b4ee4e38</span><span class="p">)]),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{})</span> <span class="n">on</span> <span class="n">default</span>
<span class="p">[</span><span class="n">redun</span><span class="p">]</span> <span class="n">Check</span> <span class="n">cache</span> <span class="nb">compile</span> <span class="p">(</span><span class="n">eval_hash</span><span class="o">=</span><span class="mi">2872</span><span class="n">aec1</span><span class="p">)</span><span class="o">...</span>
<span class="p">[</span><span class="n">redun</span><span class="p">]</span> <span class="n">Check</span> <span class="n">cache</span> <span class="nb">compile</span> <span class="p">(</span><span class="n">eval_hash</span><span class="o">=</span><span class="mi">6</span><span class="n">d665ff5</span><span class="p">)</span><span class="o">...</span>
<span class="p">[</span><span class="n">redun</span><span class="p">]</span> <span class="n">Run</span> <span class="nb">compile</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">lib</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="n">e8ff8720b689411145e97dec7d0f8ad9b4ee4e38</span><span class="p">),),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{})</span> <span class="n">on</span> <span class="n">default</span>
<span class="p">[</span><span class="n">redun</span><span class="p">]</span> <span class="n">Check</span> <span class="n">cache</span> <span class="nb">compile</span> <span class="p">(</span><span class="n">eval_hash</span><span class="o">=</span><span class="n">ee7f4a1a</span><span class="p">)</span><span class="o">...</span>
<span class="p">[</span><span class="n">redun</span><span class="p">]</span> <span class="n">Check</span> <span class="n">cache</span> <span class="n">link</span> <span class="p">(</span><span class="n">eval_hash</span><span class="o">=</span><span class="mi">3</span><span class="n">fcc3117</span><span class="p">)</span><span class="o">...</span>
<span class="p">[</span><span class="n">redun</span><span class="p">]</span> <span class="n">Run</span> <span class="n">link</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;prog&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">prog</span><span class="o">.</span><span class="n">o</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="n">ea439e92541937ec0777210367ed8a05ec91dad0</span><span class="p">),</span> <span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">lib</span><span class="o">.</span><span class="n">o</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="mi">6370</span><span class="n">c13da0a6ca01177f4b42b043d5cd860351d6</span><span class="p">)]),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{})</span> <span class="n">on</span> <span class="n">default</span>
<span class="p">[</span><span class="n">redun</span><span class="p">]</span> <span class="n">Check</span> <span class="n">cache</span> <span class="n">link</span> <span class="p">(</span><span class="n">eval_hash</span><span class="o">=</span><span class="mi">9</span><span class="n">b3784ce</span><span class="p">)</span><span class="o">...</span>
<span class="p">[</span><span class="n">redun</span><span class="p">]</span> <span class="n">Run</span> <span class="n">link</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;prog2&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">prog2</span><span class="o">.</span><span class="n">o</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="mf">60e8</span><span class="n">a5e97fe8b6064d0655c1eee16ff6dd650946</span><span class="p">),</span> <span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">lib</span><span class="o">.</span><span class="n">o</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="mi">6370</span><span class="n">c13da0a6ca01177f4b42b043d5cd860351d6</span><span class="p">)]),</span> <span class="n">kwargs</span><span class="o">=</span><span class="p">{})</span> <span class="n">on</span> <span class="n">default</span>
<span class="p">[</span><span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">prog</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="mi">6</span><span class="n">daae76807abc212f1085b43b76003821314309f</span><span class="p">),</span>
 <span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">prog2</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="mi">62</span><span class="n">a3a615ed8e6f5265f76f3603df8f58790ba1d6</span><span class="p">)]</span>
</pre></div>
</div>
<p>We should see our change reflected in the new binary:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>./prog

prog1: Hello, World!!!!!!!!
</pre></div>
</div>
<p>Now, let’s look at the call graphs recorded so far. We can list past executions like so:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>redun<span class="w"> </span>log

Recent<span class="w"> </span>executions:
<span class="w">  </span>Exec<span class="w"> </span>a5583da5-3787-4324-86c9-ad988753cd2e<span class="w"> </span><span class="m">2020</span>-06-26<span class="w"> </span><span class="m">22</span>:21:32:<span class="w">  </span><span class="nv">args</span><span class="o">=</span>run<span class="w"> </span>make.py<span class="w"> </span>make
<span class="w">  </span>Exec<span class="w"> </span>3bd1e113-d88f-4671-a996-4b2feb5aa58b<span class="w"> </span><span class="m">2020</span>-06-26<span class="w"> </span><span class="m">22</span>:15:03:<span class="w">  </span><span class="nv">args</span><span class="o">=</span>run<span class="w"> </span>make.py<span class="w"> </span>make
</pre></div>
</div>
<p>Each execution is given a unique id (UUID). To list more information about a specific execution, simply supply it to the <code class="docutils literal notranslate"><span class="pre">redun</span> <span class="pre">log</span></code> command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">redun</span> <span class="n">log</span> <span class="n">a5583da5</span><span class="o">-</span><span class="mi">3787</span><span class="o">-</span><span class="mi">4324</span><span class="o">-</span><span class="mi">86</span><span class="n">c9</span><span class="o">-</span><span class="n">ad988753cd2e</span>

<span class="n">Exec</span> <span class="n">a5583da5</span><span class="o">-</span><span class="mi">3787</span><span class="o">-</span><span class="mi">4324</span><span class="o">-</span><span class="mi">86</span><span class="n">c9</span><span class="o">-</span><span class="n">ad988753cd2e</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">26</span> <span class="mi">22</span><span class="p">:</span><span class="mi">21</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span>  <span class="n">args</span><span class="o">=</span><span class="n">run</span> <span class="n">make</span><span class="o">.</span><span class="n">py</span> <span class="n">make</span>
  <span class="n">Job</span> <span class="mi">1604</span><span class="n">f4c0</span><span class="o">-</span><span class="n">aca0</span><span class="o">-</span><span class="mi">437</span><span class="n">b</span><span class="o">-</span><span class="n">b5ae</span><span class="o">-</span><span class="mi">2741954</span><span class="n">fafbd</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">26</span> <span class="mi">22</span><span class="p">:</span><span class="mi">21</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span>  <span class="n">task</span><span class="p">:</span> <span class="n">make</span><span class="p">,</span> <span class="n">task_hash</span><span class="p">:</span> <span class="mi">0</span><span class="n">d9dca7d</span><span class="p">,</span> <span class="n">call_node</span><span class="p">:</span> <span class="n">c2de7619</span><span class="p">,</span> <span class="n">cached</span><span class="p">:</span> <span class="kc">False</span>
    <span class="n">Job</span> <span class="mi">7</span><span class="n">bc38754</span><span class="o">-</span><span class="mi">8741</span><span class="o">-</span><span class="mi">4302</span><span class="o">-</span><span class="n">ae81</span><span class="o">-</span><span class="mi">08</span><span class="n">d043b345aa</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">26</span> <span class="mi">22</span><span class="p">:</span><span class="mi">21</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span>  <span class="n">task</span><span class="p">:</span> <span class="n">make_prog</span><span class="p">,</span> <span class="n">task_hash</span><span class="p">:</span> <span class="mi">16</span><span class="n">aa763c</span><span class="p">,</span> <span class="n">call_node</span><span class="p">:</span> <span class="mi">88</span><span class="n">f47605</span><span class="p">,</span> <span class="n">cached</span><span class="p">:</span> <span class="kc">False</span>
      <span class="n">Job</span> <span class="mi">1</span><span class="n">f4b4a76</span><span class="o">-</span><span class="n">a920</span><span class="o">-</span><span class="mi">4</span><span class="n">b6a</span><span class="o">-</span><span class="mi">8323</span><span class="o">-</span><span class="mi">1</span><span class="n">df9876354e3</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">26</span> <span class="mi">22</span><span class="p">:</span><span class="mi">21</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span>  <span class="n">task</span><span class="p">:</span> <span class="nb">compile</span><span class="p">,</span> <span class="n">task_hash</span><span class="p">:</span> <span class="n">d2b031e4</span><span class="p">,</span> <span class="n">call_node</span><span class="p">:</span> <span class="n">fedc6cdc</span><span class="p">,</span> <span class="n">cached</span><span class="p">:</span> <span class="kc">True</span>
      <span class="n">Job</span> <span class="n">bfa81ca0</span><span class="o">-</span><span class="mi">1897</span><span class="o">-</span><span class="mf">4e88</span><span class="o">-</span><span class="mi">8</span><span class="n">be9</span><span class="o">-</span><span class="mi">030941</span><span class="n">dae648</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">26</span> <span class="mi">22</span><span class="p">:</span><span class="mi">21</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span>  <span class="n">task</span><span class="p">:</span> <span class="nb">compile</span><span class="p">,</span> <span class="n">task_hash</span><span class="p">:</span> <span class="n">d2b031e4</span><span class="p">,</span> <span class="n">call_node</span><span class="p">:</span> <span class="mi">7872899</span><span class="n">b</span><span class="p">,</span> <span class="n">cached</span><span class="p">:</span> <span class="kc">False</span>
      <span class="n">Job</span> <span class="mi">96681441</span><span class="o">-</span><span class="n">e186</span><span class="o">-</span><span class="mi">42</span><span class="n">f7</span><span class="o">-</span><span class="mf">9e99</span><span class="o">-</span><span class="mi">663</span><span class="n">fc0d0d08c</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">26</span> <span class="mi">22</span><span class="p">:</span><span class="mi">21</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span>  <span class="n">task</span><span class="p">:</span> <span class="n">link</span><span class="p">,</span> <span class="n">task_hash</span><span class="p">:</span> <span class="n">e73b3cd2</span><span class="p">,</span> <span class="n">call_node</span><span class="p">:</span> <span class="mi">1</span><span class="n">ddb7325</span><span class="p">,</span> <span class="n">cached</span><span class="p">:</span> <span class="kc">False</span>
    <span class="n">Job</span> <span class="n">e0109842</span><span class="o">-</span><span class="mi">8</span><span class="n">a69</span><span class="o">-</span><span class="mi">4</span><span class="n">a4c</span><span class="o">-</span><span class="n">b2c6</span><span class="o">-</span><span class="mi">9</span><span class="n">b97bfd35b43</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">26</span> <span class="mi">22</span><span class="p">:</span><span class="mi">21</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span>  <span class="n">task</span><span class="p">:</span> <span class="n">make_prog</span><span class="p">,</span> <span class="n">task_hash</span><span class="p">:</span> <span class="mi">16</span><span class="n">aa763c</span><span class="p">,</span> <span class="n">call_node</span><span class="p">:</span> <span class="mf">4453e6</span><span class="n">cd</span><span class="p">,</span> <span class="n">cached</span><span class="p">:</span> <span class="kc">False</span>
      <span class="n">Job</span> <span class="mi">94830</span><span class="n">f60</span><span class="o">-</span><span class="n">acaa</span><span class="o">-</span><span class="mi">4</span><span class="n">b6b</span><span class="o">-</span><span class="mi">9</span><span class="n">b22</span><span class="o">-</span><span class="n">f4572c64f85b</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">26</span> <span class="mi">22</span><span class="p">:</span><span class="mi">21</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span>  <span class="n">task</span><span class="p">:</span> <span class="nb">compile</span><span class="p">,</span> <span class="n">task_hash</span><span class="p">:</span> <span class="n">d2b031e4</span><span class="p">,</span> <span class="n">call_node</span><span class="p">:</span> <span class="mi">1</span><span class="n">dc10a1c</span><span class="p">,</span> <span class="n">cached</span><span class="p">:</span> <span class="kc">True</span>
      <span class="n">Job</span> <span class="mi">7935</span><span class="n">a494</span><span class="o">-</span><span class="mi">01</span><span class="n">f6</span><span class="o">-</span><span class="mi">47</span><span class="n">ff</span><span class="o">-</span><span class="mi">8657</span><span class="o">-</span><span class="n">b8877bfe1e84</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">26</span> <span class="mi">22</span><span class="p">:</span><span class="mi">21</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span>  <span class="n">task</span><span class="p">:</span> <span class="n">link</span><span class="p">,</span> <span class="n">task_hash</span><span class="p">:</span> <span class="n">e73b3cd2</span><span class="p">,</span> <span class="n">call_node</span><span class="p">:</span> <span class="n">bab7987a</span><span class="p">,</span> <span class="n">cached</span><span class="p">:</span> <span class="kc">False</span>
</pre></div>
</div>
<p>Now, we can see the tree of Jobs and information about each one, such as the task, task_hash, CallNode hash, and whether the result was cached. To display information about any specific object (Job, Task, CallNode) simply use <code class="docutils literal notranslate"><span class="pre">redun</span> <span class="pre">log</span> <span class="pre">&lt;id_or_hash_prefix&gt;</span></code>. We can get more information about the link Task (<code class="docutils literal notranslate"><span class="pre">e73b3cd2</span></code>) like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">redun</span> <span class="n">log</span> <span class="n">e73b3cd2</span>

<span class="n">Task</span> <span class="n">link</span> <span class="n">e73b3cd20246b559ac2b9c2933efe953612cc3ab</span>
    <span class="n">First</span> <span class="n">job</span> <span class="mi">88</span><span class="n">eb9fd6</span> <span class="mi">2020</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">26</span> <span class="mi">22</span><span class="p">:</span><span class="mi">15</span><span class="p">:</span><span class="mf">07.424194</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">link</span><span class="p">(</span><span class="n">prog_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">o_files</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">File</span><span class="p">]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Link several object files together into one program.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;gcc -o </span><span class="si">{prog_path}</span><span class="s2"> </span><span class="si">{o_files}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">prog_path</span><span class="o">=</span><span class="n">prog_path</span><span class="p">,</span>
            <span class="n">o_files</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">o_file</span><span class="o">.</span><span class="n">path</span> <span class="k">for</span> <span class="n">o_file</span> <span class="ow">in</span> <span class="n">o_files</span><span class="p">),</span>
        <span class="p">))</span>
        <span class="k">return</span> <span class="n">File</span><span class="p">(</span><span class="n">prog_path</span><span class="p">)</span>
</pre></div>
</div>
<p>Here we see the source code of the task at the time it was run. We can also get more information about the CallNode (<code class="docutils literal notranslate"><span class="pre">bab7987a</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">redun</span> <span class="n">log</span> <span class="n">bab7987a</span>

<span class="n">CallNode</span> <span class="n">bab7987ae6157f5dea825730e8020470a41c8f0c</span> <span class="n">task_name</span><span class="p">:</span> <span class="n">link</span><span class="p">,</span> <span class="n">task_hash</span><span class="p">:</span> <span class="n">e73b3cd2</span>
  <span class="n">Result</span><span class="p">:</span> <span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">prog2</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="mi">62</span><span class="n">a3a615ed8e6f5265f76f3603df8f58790ba1d6</span><span class="p">)</span>
  <span class="n">Parent</span> <span class="n">CallNodes</span><span class="p">:</span>
    <span class="n">CallNode</span> <span class="mf">4453e6</span><span class="n">cd53c7f1c92dedebcd05e73a19b0ef08d9</span> <span class="n">task_name</span><span class="p">:</span> <span class="n">make_prog</span><span class="p">,</span> <span class="n">task_hash</span><span class="p">:</span> <span class="mi">16</span><span class="n">aa763c</span>
</pre></div>
</div>
<p>We can also query by file name. Which CallNode created file <code class="docutils literal notranslate"><span class="pre">prog</span></code>?</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">redun</span> <span class="n">log</span> <span class="n">prog</span>

<span class="n">File</span><span class="p">(</span><span class="nb">hash</span><span class="o">=</span><span class="s1">&#39;6daae768&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;prog&#39;</span><span class="p">):</span>
  <span class="o">-</span> <span class="n">Produced</span> <span class="n">by</span> <span class="n">CallNode</span><span class="p">(</span><span class="nb">hash</span><span class="o">=</span><span class="s1">&#39;1ddb7325&#39;</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s1">&#39;link&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;prog&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">prog</span><span class="o">.</span><span class="n">o</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="n">ea439e92541937ec0777210367ed8a05ec91dad0</span><span class="p">),</span> <span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">lib</span><span class="o">.</span><span class="n">o</span><span class="p">,</span> <span class="n">has</span><span class="o">...</span><span class="p">])</span>
  <span class="o">-</span> <span class="n">During</span> <span class="n">Job</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;96681441&#39;</span><span class="p">,</span> <span class="n">start_time</span><span class="o">=</span><span class="s1">&#39;2020-06-26 22:21:32&#39;</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s1">&#39;link&#39;</span><span class="p">)</span>

  <span class="n">Task</span> <span class="n">link</span> <span class="n">e73b3cd20246b559ac2b9c2933efe953612cc3ab</span>
      <span class="k">def</span><span class="w"> </span><span class="nf">link</span><span class="p">(</span><span class="n">prog_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">o_files</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">File</span><span class="p">]):</span>
<span class="w">          </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">          Link several object files together into one program.</span>
<span class="sd">          &quot;&quot;&quot;</span>
          <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;gcc -o </span><span class="si">{prog_path}</span><span class="s2"> </span><span class="si">{o_files}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
              <span class="n">prog_path</span><span class="o">=</span><span class="n">prog_path</span><span class="p">,</span>
              <span class="n">o_files</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">o_file</span><span class="o">.</span><span class="n">path</span> <span class="k">for</span> <span class="n">o_file</span> <span class="ow">in</span> <span class="n">o_files</span><span class="p">),</span>
          <span class="p">))</span>
          <span class="k">return</span> <span class="n">File</span><span class="p">(</span><span class="n">prog_path</span><span class="p">)</span>
</pre></div>
</div>
<p>Which task read <code class="docutils literal notranslate"><span class="pre">prog.c</span></code>?</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">redun</span> <span class="n">log</span> <span class="n">prog</span><span class="o">.</span><span class="n">c</span>

<span class="n">File</span><span class="p">(</span><span class="nb">hash</span><span class="o">=</span><span class="s1">&#39;574d39e6&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;prog.c&#39;</span><span class="p">):</span>
  <span class="o">-</span> <span class="n">Consumed</span> <span class="n">by</span> <span class="n">CallNode</span><span class="p">(</span><span class="nb">hash</span><span class="o">=</span><span class="s1">&#39;fedc6cdc&#39;</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s1">&#39;compile&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">prog</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="mi">574</span><span class="n">d39e642f407119c2661559cea39d491bd3dc1</span><span class="p">)])</span>
  <span class="o">-</span> <span class="n">During</span> <span class="n">Job</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;1f4b4a76&#39;</span><span class="p">,</span> <span class="n">start_time</span><span class="o">=</span><span class="s1">&#39;2020-06-26 22:21:32&#39;</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s1">&#39;compile&#39;</span><span class="p">)</span>

  <span class="n">Task</span> <span class="nb">compile</span> <span class="n">d2b031e48e7f491a3d05a12f243f967517b25236</span>
      <span class="k">def</span><span class="w"> </span><span class="nf">compile</span><span class="p">(</span><span class="n">c_file</span><span class="p">:</span> <span class="n">File</span><span class="p">):</span>
<span class="w">          </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">          Compile one C file into an object file.</span>
<span class="sd">          &quot;&quot;&quot;</span>
          <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;gcc -c </span><span class="si">{c_file}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">c_file</span><span class="o">=</span><span class="n">c_file</span><span class="o">.</span><span class="n">path</span><span class="p">))</span>
          <span class="k">return</span> <span class="n">File</span><span class="p">(</span><span class="n">c_file</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.c&#39;</span><span class="p">,</span> <span class="s1">&#39;.o&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>We can also walk the CallGraph using SQLAlechemy. The command <code class="docutils literal notranslate"><span class="pre">redun</span> <span class="pre">repl</span></code> gives us an interactive read-eval-print-loop (REPL). There is a builtin function <code class="docutils literal notranslate"><span class="pre">query()</span></code> that can retrieve any object by an id prefix:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">redun</span> <span class="n">repl</span>

<span class="p">(</span><span class="n">redun</span><span class="p">)</span> <span class="n">call_node</span> <span class="o">=</span> <span class="n">query</span><span class="p">(</span><span class="s1">&#39;bab7987a&#39;</span><span class="p">)</span>
<span class="p">(</span><span class="n">redun</span><span class="p">)</span> <span class="n">call_node</span>
<span class="n">CallNode</span><span class="p">(</span><span class="nb">hash</span><span class="o">=</span><span class="s1">&#39;bab7987a&#39;</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s1">&#39;link&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;prog2&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">prog2</span><span class="o">.</span><span class="n">o</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="mf">60e8</span><span class="n">a5e97fe8b6064d0655c1eee16ff6dd650946</span><span class="p">),</span> <span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">lib</span><span class="o">.</span><span class="n">o</span><span class="p">,</span> <span class="n">h</span><span class="o">...</span><span class="p">])</span>

<span class="p">(</span><span class="n">redun</span><span class="p">)</span> <span class="n">call_node</span><span class="o">.</span><span class="n">value</span>
<span class="n">Value</span><span class="p">(</span><span class="nb">hash</span><span class="o">=</span><span class="s1">&#39;62a3a615&#39;</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">prog2</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="mi">62</span><span class="n">a3a615ed8e6f5265f76f3603df8f58790ba1d6</span><span class="p">))</span>

<span class="p">(</span><span class="n">redun</span><span class="p">)</span> <span class="n">call_node</span><span class="o">.</span><span class="n">arguments</span>
<span class="p">[</span><span class="n">Argument</span><span class="p">(</span><span class="n">task_name</span><span class="o">=</span><span class="s1">&#39;link&#39;</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">prog2</span><span class="p">),</span> <span class="n">Argument</span><span class="p">(</span><span class="n">task_name</span><span class="o">=</span><span class="s1">&#39;link&#39;</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="p">[</span><span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">prog2</span><span class="o">.</span><span class="n">o</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="mf">60e8</span><span class="n">a5e97fe8b6064d0655c1eee16ff6dd650946</span><span class="p">),</span> <span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">lib</span><span class="o">.</span><span class="n">o</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="mi">6370</span><span class="n">c13da0a6ca01177f4b42b043d5cd860351d6</span><span class="p">)])]</span>

<span class="p">(</span><span class="n">redun</span><span class="p">)</span> <span class="n">call_node</span><span class="o">.</span><span class="n">parents</span>
<span class="p">[</span><span class="n">CallNode</span><span class="p">(</span><span class="nb">hash</span><span class="o">=</span><span class="s1">&#39;4453e6cd&#39;</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s1">&#39;make_prog&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;prog2&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">prog2</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="n">b262cdb5130e8984ed3bb0dba8c83e56173ed702</span><span class="p">),</span> <span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">lib</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="n">h</span><span class="o">...</span><span class="p">])]</span>

<span class="p">(</span><span class="n">redun</span><span class="p">)</span> <span class="n">call_node</span><span class="o">.</span><span class="n">task</span>
<span class="n">Task</span><span class="p">(</span><span class="nb">hash</span><span class="o">=</span><span class="s1">&#39;e73b3cd2&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;link&#39;</span><span class="p">)</span>

<span class="p">(</span><span class="n">redun</span><span class="p">)</span> <span class="nb">print</span><span class="p">(</span><span class="n">call_node</span><span class="o">.</span><span class="n">task</span><span class="o">.</span><span class="n">source</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">link</span><span class="p">(</span><span class="n">prog_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">o_files</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">File</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Link several object files together into one program.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;gcc -o </span><span class="si">{prog_path}</span><span class="s2"> </span><span class="si">{o_files}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">prog_path</span><span class="o">=</span><span class="n">prog_path</span><span class="p">,</span>
        <span class="n">o_files</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">o_file</span><span class="o">.</span><span class="n">path</span> <span class="k">for</span> <span class="n">o_file</span> <span class="ow">in</span> <span class="n">o_files</span><span class="p">),</span>
    <span class="p">))</span>
    <span class="k">return</span> <span class="n">File</span><span class="p">(</span><span class="n">prog_path</span><span class="p">)</span>

<span class="p">(</span><span class="n">redun</span><span class="p">)</span> <span class="n">call_node</span><span class="o">.</span><span class="n">parents</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">CallNode</span><span class="p">(</span><span class="nb">hash</span><span class="o">=</span><span class="s1">&#39;4453e6cd&#39;</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="s1">&#39;make_prog&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;prog2&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">prog2</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="nb">hash</span><span class="o">=</span><span class="n">b262cdb5130e8984ed3bb0dba8c83e56173ed702</span><span class="p">),</span> <span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="n">lib</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="n">h</span><span class="o">...</span><span class="p">])</span>

<span class="p">(</span><span class="n">redun</span><span class="p">)</span> <span class="nb">print</span><span class="p">(</span><span class="n">call_node</span><span class="o">.</span><span class="n">parents</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">task</span><span class="o">.</span><span class="n">source</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">make_prog</span><span class="p">(</span><span class="n">prog_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">c_files</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">File</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compile one program from its source C files.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">o_files</span> <span class="o">=</span> <span class="p">[</span>
        <span class="nb">compile</span><span class="p">(</span><span class="n">c_file</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">c_file</span> <span class="ow">in</span> <span class="n">c_files</span>
    <span class="p">]</span>
    <span class="n">prog_file</span> <span class="o">=</span> <span class="n">link</span><span class="p">(</span><span class="n">prog_path</span><span class="p">,</span> <span class="n">o_files</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">prog_file</span>
</pre></div>
</div>
</section>
<section id="syncing-provenance-data">
<h2>Syncing provenance data<a class="headerlink" href="#syncing-provenance-data" title="Link to this heading">¶</a></h2>
<p>The redun database (stored in <code class="docutils literal notranslate"><span class="pre">.redun/redun.db</span></code> by default) is designed to be retained for long term storage and analysis. To aid this, the redun CLI provides several commands to make backing up and syncing databases easy.</p>
<section id="repositories">
<h3>Repositories<a class="headerlink" href="#repositories" title="Link to this heading">¶</a></h3>
<p>Redun organizes data provenance into repositories (“repos” for short) similar to how git organizes code in repos. By default, all provenance is tracked in the default, nameless repository.</p>
<p>Additional named repositories may be added with <code class="docutils literal notranslate"><span class="pre">redun</span> <span class="pre">repo</span> <span class="pre">add</span> <span class="pre">&lt;repo</span> <span class="pre">name&gt;</span> <span class="pre">&lt;config</span> <span class="pre">dir&gt;</span></code>. The configuration for the repository may be local or on S3.</p>
<p>Available repositories can be enumerated with <code class="docutils literal notranslate"><span class="pre">redun</span> <span class="pre">repo</span> <span class="pre">list</span></code>.</p>
<p>Removing repositories via the command line is not currently supported, but <code class="docutils literal notranslate"><span class="pre">redun</span> <span class="pre">repo</span> <span class="pre">remove</span> <span class="pre">&lt;repo</span> <span class="pre">name&gt;</span></code> will instruct you on how to edit your config file.</p>
</section>
<section id="running-redun-in-other-repositories">
<h3>Running redun in other repositories<a class="headerlink" href="#running-redun-in-other-repositories" title="Link to this heading">¶</a></h3>
<p>To run redun commands in a different database, <code class="docutils literal notranslate"><span class="pre">redun</span> <span class="pre">--repo</span> <span class="pre">&lt;repo</span> <span class="pre">name&gt;</span> <span class="pre">&lt;command&gt;</span></code> will work for most commands. For example, <code class="docutils literal notranslate"><span class="pre">redun</span> <span class="pre">--repo</span> <span class="pre">foo</span> <span class="pre">log</span> <span class="pre">--task</span></code> will print tasks present in the “foo” repository.</p>
</section>
<section id="synchronizing-repositories">
<h3>Synchronizing repositories<a class="headerlink" href="#synchronizing-repositories" title="Link to this heading">¶</a></h3>
<p>Just like git, <code class="docutils literal notranslate"><span class="pre">redun</span> <span class="pre">pull</span> <span class="pre">&lt;repo&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">redun</span> <span class="pre">push</span> <span class="pre">&lt;repo&gt;</span></code> will synchronize data to and from remote repositories.</p>
<p>You can also sync from remote to remote: <code class="docutils literal notranslate"><span class="pre">redun</span> <span class="pre">--repo</span> <span class="pre">foo</span> <span class="pre">push</span> <span class="pre">bar</span></code> will push all records from repository “foo” to “bar”. The number of records pushed will be displayed.</p>
</section>
<section id="manual-exports">
<h3>Manual exports<a class="headerlink" href="#manual-exports" title="Link to this heading">¶</a></h3>
<p>First, the database can be exported to a JSON log format using the <code class="docutils literal notranslate"><span class="pre">redun</span> <span class="pre">export</span></code> command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">redun</span> <span class="n">export</span>

<span class="p">{</span><span class="s2">&quot;_version&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;_type&quot;</span><span class="p">:</span> <span class="s2">&quot;Value&quot;</span><span class="p">,</span> <span class="s2">&quot;value_hash&quot;</span><span class="p">:</span> <span class="s2">&quot;60e8a5e97fe8b6064d0655c1eee16ff6dd650946&quot;</span><span class="p">,</span> <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;redun.File&quot;</span><span class="p">,</span> <span class="s2">&quot;format&quot;</span><span class="p">:</span> <span class="s2">&quot;application/python-pickle&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;gANjcmVkdW4uZmlsZQpGaWxlCnEAKYFxAX1xAihYBAAAAHBhdGhxA1gHAAAAcHJvZzIub3EEWAQAAABoYXNocQVYKAAAADYwZThhNWU5N2ZlOGI2MDY0ZDA2NTVjMWVlZTE2ZmY2ZGQ2NTA5NDZxBnViLg==&quot;</span><span class="p">,</span> <span class="s2">&quot;subvalues&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;file_path&quot;</span><span class="p">:</span> <span class="s2">&quot;prog2.o&quot;</span><span class="p">}</span>
<span class="p">{</span><span class="s2">&quot;_version&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;_type&quot;</span><span class="p">:</span> <span class="s2">&quot;Task&quot;</span><span class="p">,</span> <span class="s2">&quot;task_hash&quot;</span><span class="p">:</span> <span class="s2">&quot;e73b3cd20246b559ac2b9c2933efe953612cc3ab&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;link&quot;</span><span class="p">,</span> <span class="s2">&quot;namespace&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;def link(prog_path: str, o_files: List[File]):</span><span class="se">\n</span><span class="s2">    </span><span class="se">\&quot;\&quot;\&quot;\n</span><span class="s2">    Link several object files together into one program.</span><span class="se">\n</span><span class="s2">    </span><span class="se">\&quot;\&quot;\&quot;\n</span><span class="s2">    print(</span><span class="se">\&quot;</span><span class="s2">linking</span><span class="se">\&quot;</span><span class="s2">)</span><span class="se">\n</span><span class="s2">    os.system(</span><span class="se">\&quot;</span><span class="s2">gcc -o </span><span class="si">{prog_path}</span><span class="s2"> </span><span class="si">{o_files}</span><span class="se">\&quot;</span><span class="s2">.format(</span><span class="se">\n</span><span class="s2">        prog_path=prog_path,</span><span class="se">\n</span><span class="s2">        o_files=&#39; &#39;.join(o_file.path for o_file in o_files),</span><span class="se">\n</span><span class="s2">    ))</span><span class="se">\n</span><span class="s2">    return File(prog_path)</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">}</span>
<span class="p">{</span><span class="s2">&quot;_version&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;_type&quot;</span><span class="p">:</span> <span class="s2">&quot;CallNode&quot;</span><span class="p">,</span> <span class="s2">&quot;call_hash&quot;</span><span class="p">:</span> <span class="s2">&quot;1dc10a1cbf5696b00d1b6f3e9da2473ba088e033&quot;</span><span class="p">,</span> <span class="s2">&quot;task_name&quot;</span><span class="p">:</span> <span class="s2">&quot;compile&quot;</span><span class="p">,</span> <span class="s2">&quot;task_hash&quot;</span><span class="p">:</span> <span class="s2">&quot;d2b031e48e7f491a3d05a12f243f967517b25236&quot;</span><span class="p">,</span> <span class="s2">&quot;args_hash&quot;</span><span class="p">:</span> <span class="s2">&quot;df25928d0785108768a019cdb8f856c5013c97ec&quot;</span><span class="p">,</span> <span class="s2">&quot;value_hash&quot;</span><span class="p">:</span> <span class="s2">&quot;60e8a5e97fe8b6064d0655c1eee16ff6dd650946&quot;</span><span class="p">,</span> <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;2020-06-27 05:15:07.464279&quot;</span><span class="p">,</span> <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;0&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;arg_hash&quot;</span><span class="p">:</span> <span class="s2">&quot;16ce4470a4242d1c246d1c15a00487d73ce24efd&quot;</span><span class="p">,</span> <span class="s2">&quot;value_hash&quot;</span><span class="p">:</span> <span class="s2">&quot;b262cdb5130e8984ed3bb0dba8c83e56173ed702&quot;</span><span class="p">,</span> <span class="s2">&quot;upstream&quot;</span><span class="p">:</span> <span class="p">[]}},</span> <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="p">[]}</span>
<span class="p">{</span><span class="s2">&quot;_version&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;_type&quot;</span><span class="p">:</span> <span class="s2">&quot;Job&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;94830f60-acaa-4b6b-9b22-f4572c64f85b&quot;</span><span class="p">,</span> <span class="s2">&quot;start_time&quot;</span><span class="p">:</span> <span class="s2">&quot;2020-06-26 22:21:32.266311&quot;</span><span class="p">,</span> <span class="s2">&quot;end_time&quot;</span><span class="p">:</span> <span class="s2">&quot;2020-06-26 22:21:32.283055&quot;</span><span class="p">,</span> <span class="s2">&quot;task_hash&quot;</span><span class="p">:</span> <span class="s2">&quot;d2b031e48e7f491a3d05a12f243f967517b25236&quot;</span><span class="p">,</span> <span class="s2">&quot;cached&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span> <span class="s2">&quot;call_hash&quot;</span><span class="p">:</span> <span class="s2">&quot;1dc10a1cbf5696b00d1b6f3e9da2473ba088e033&quot;</span><span class="p">,</span> <span class="s2">&quot;parent_id&quot;</span><span class="p">:</span> <span class="s2">&quot;e0109842-8a69-4a4c-b2c6-9b97bfd35b43&quot;</span><span class="p">,</span> <span class="s2">&quot;children&quot;</span><span class="p">:</span> <span class="p">[]}</span>
<span class="p">{</span><span class="s2">&quot;_version&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;_type&quot;</span><span class="p">:</span> <span class="s2">&quot;Execution&quot;</span><span class="p">,</span> <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;6393500c-313c-43d7-87d4-d6feaeefaaab&quot;</span><span class="p">,</span> <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="s2">&quot;[</span><span class="se">\&quot;</span><span class="s2">/Users/rasmus/projects/redun.dev/.venv/bin/redun</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">run</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">make.py</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">make</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">--config</span><span class="se">\&quot;</span><span class="s2">, </span><span class="se">\&quot;</span><span class="s2">12</span><span class="se">\&quot;</span><span class="s2">]&quot;</span><span class="p">,</span> <span class="s2">&quot;job_id&quot;</span><span class="p">:</span> <span class="s2">&quot;e060d21c-108e-4cfb-ad11-04e19ae4d460&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>These JSON logs can be imported into another redun database using <code class="docutils literal notranslate"><span class="pre">redun</span> <span class="pre">import</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Export logs.</span>
<span class="n">redun</span> <span class="n">export</span> <span class="o">&gt;</span> <span class="n">logs</span><span class="o">.</span><span class="n">json</span>

<span class="n">wc</span> <span class="o">-</span><span class="n">l</span> <span class="n">logs</span><span class="o">.</span><span class="n">json</span>
<span class="c1"># 99</span>

<span class="c1"># Create a new redun database.</span>
<span class="n">redun</span> <span class="o">--</span><span class="n">config</span> <span class="n">redun2</span> <span class="n">init</span>

<span class="c1"># Second database should be empty initially.</span>
<span class="n">redun</span> <span class="o">--</span><span class="n">config</span> <span class="n">redun2</span> <span class="n">export</span> <span class="o">|</span> <span class="n">wc</span> <span class="o">-</span><span class="n">l</span>
<span class="c1"># 0</span>

<span class="c1"># Import logs into second database.</span>
<span class="n">redun</span> <span class="o">--</span><span class="n">config</span> <span class="n">redun2</span> <span class="kn">import</span><span class="w"> </span><span class="o">&lt;</span> <span class="n">logs</span><span class="o">.</span><span class="n">json</span>

<span class="c1"># Second database is now populated.</span>
<span class="n">redun</span> <span class="o">--</span><span class="n">config</span> <span class="n">redun2</span> <span class="n">export</span> <span class="o">|</span> <span class="n">wc</span> <span class="o">-</span><span class="n">l</span>
<span class="c1"># 99</span>
</pre></div>
</div>
<p>The import command is <a class="reference external" href="https://en.wikipedia.org/wiki/Idempotence">idempotent</a>, so you can safely import log files that might contain records that already exist in the database, and redun will correctly only import the new records and avoid double insertions. Since records are immutable, there is no need to perform any updates or deletes, only inserts. Every record has a unique id that is either a hash or UUID, and therefore reconciling matching records is trivial.</p>
<p>redun can also efficiently sync new records using the <code class="docutils literal notranslate"><span class="pre">push</span></code> command, which works similar to <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span></code>:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># Push to another repo.</span>
redun<span class="w"> </span>repo<span class="w"> </span>add<span class="w"> </span>other_repo<span class="w"> </span>redun2
redun<span class="w"> </span>push<span class="w"> </span>other_repo
</pre></div>
</div>
<p>This efficient sync is done by performing a graph walk of the redun database, similar to the <a class="reference external" href="https://matthew-brett.github.io/curious-git/git_push_algorithm.html">approach used by git</a>.</p>
<p>It is envisioned that the <code class="docutils literal notranslate"><span class="pre">push</span></code> command can be used in a data science workflow, where a data scientist could complete their analysis by pushing both their code provenance (version control) and their data provenance to central databases to share with their team.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># Share your code provenance.</span>
git<span class="w"> </span>push<span class="w"> </span>origin<span class="w"> </span>main

<span class="c1"># Share your data provenance.</span>
redun<span class="w"> </span>push<span class="w"> </span>prod
</pre></div>
</div>
</section>
</section>
<section id="database-migration">
<h2>Database migration<a class="headerlink" href="#database-migration" title="Link to this heading">¶</a></h2>
<p>The redun CLI will automatically initialize and upgrade the redun database in most cases, so users will oftentimes not need to manage database versioning themselves. However, there are certain situations where users may want or need to manage database upgrades explicitly, such as upgrading a central shared PostgreSQL database. Here, we review common commands for inspecting and managing database version upgrades.</p>
<p>When the redun CLI is run for the first on a workflow script, by default a new sqlite database is created at <code class="docutils literal notranslate"><span class="pre">.redun/redun.db</span></code>.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>redun<span class="w"> </span>run<span class="w"> </span>workflow.py<span class="w"> </span>main

<span class="c1"># .redun/redun.db sqlite database is created and upgraded to latest version known to the CLI.</span>
</pre></div>
</div>
<p>The version of the database can be queried using <code class="docutils literal notranslate"><span class="pre">redun</span> <span class="pre">db</span> <span class="pre">info</span></code>, which should produce output something like:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>redun<span class="w"> </span>::<span class="w"> </span>version<span class="w"> </span><span class="m">0</span>.4.11
config<span class="w"> </span>dir:<span class="w"> </span>/Users/rasmus/projects/redun/.redun

db<span class="w"> </span>version:<span class="w"> </span><span class="m">2</span>.0
CLI<span class="w"> </span>requires<span class="w"> </span>db<span class="w"> </span>versions:<span class="w"> </span>&gt;<span class="o">=</span><span class="m">2</span>,&lt;<span class="m">3</span>
CLI<span class="w"> </span>compatible<span class="w"> </span>with<span class="w"> </span>db:<span class="w"> </span>True
</pre></div>
</div>
<p>The line <code class="docutils literal notranslate"><span class="pre">CLI</span> <span class="pre">requires</span> <span class="pre">db</span> <span class="pre">versions:</span> <span class="pre">&gt;=2,&lt;3</span></code> specifies what range of database versions the currently install CLI can work with. If the CLI requires a newer database version, the database will need to be upgraded before use.</p>
<p>To see what database versions are available to the currently installed redun CLI, use the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ redun db versions

Version Migration    Description

1.0     806f5dcb11bf Prototype schema.
2.0     647c510a77b1 Initial production schema.
</pre></div>
</div>
<p>To upgrade the database to a new version, use the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ redun db upgrade 3.0

redun :: version 0.4.11
config dir: /Users/rasmus/projects/redun/.redun

Initial db version: 2.0
[redun] Upgrading db from version 2.0 to 3.0...
Final db version: 3.0
</pre></div>
</div>
<p>Downgrades can be done with <code class="docutils literal notranslate"><span class="pre">redun</span> <span class="pre">db</span> <span class="pre">downgrade</span> <span class="pre">&lt;version&gt;</span></code>.</p>
<section id="automatic-database-upgrading">
<h3>Automatic database upgrading<a class="headerlink" href="#automatic-database-upgrading" title="Link to this heading">¶</a></h3>
<p>For the most common use case, the redun CLI uses a local sqlite database file (e.g. <code class="docutils literal notranslate"><span class="pre">.redun/redun.db</span></code>).
Since such a database is used by only one client, it is typically safe to automatically upgrade the database if needed.
Such an upgrade will happen automatically on the next <code class="docutils literal notranslate"><span class="pre">redun</span> <span class="pre">run</span> <span class="pre">...</span></code> command.
If you would like to disable automatic upgrades, it can be turned off with the <a class="reference internal" href="config.html#automigrate"><span class="std std-ref"><code class="docutils literal notranslate"><span class="pre">automigrate</span></code></span></a> configuration option.
Automigration is not used for non-sqlite databases, since a centrally used database will likely need more coordination to not disrupt clients.</p>
</section>
<section id="database-version-capabilities">
<h3>Database version capabilities<a class="headerlink" href="#database-version-capabilities" title="Link to this heading">¶</a></h3>
<p>Each version of the redun library requires the redun database to be within a specific version range. To understand what database version is required for your library or database, consult the table below.</p>
<div class="table-wrapper colwidths-auto docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>redun lib version range</p></th>
<th class="head"><p>required database version range</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>&lt;=0.4.10</p></td>
<td><p>&gt;=1 &lt;2</p></td>
</tr>
<tr class="row-odd"><td><p>&gt;=0.4.11 &lt;=0.5.0</p></td>
<td><p>&gt;=2 &lt;3</p></td>
</tr>
<tr class="row-even"><td><p>&gt;=0.5.1 &lt;=0.6.0</p></td>
<td><p>&gt;=3.0 &lt;4</p></td>
</tr>
<tr class="row-odd"><td><p>&gt;=0.6.1 &lt;=0.22.0</p></td>
<td><p>&gt;=3.1 &lt;4</p></td>
</tr>
<tr class="row-even"><td><p>&gt;=0.23.0</p></td>
<td><p>&gt;=3.4 &lt;4</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="no-downtime-migrations">
<h3>No downtime migrations<a class="headerlink" href="#no-downtime-migrations" title="Link to this heading">¶</a></h3>
<p>The compatibility ranges between the library and database are designed to allow gradual upgrades, so that redun clients never need to fully stop access.</p>
<ul class="simple">
<li><p>Migrations are designed to be <em>pre-deploy</em>, that is, they are always applied to the database (e.g. <code class="docutils literal notranslate"><span class="pre">redun</span> <span class="pre">db</span> <span class="pre">upgrade</span></code>) before upgrading clients.</p></li>
<li><p>Minor database versions (e.g <code class="docutils literal notranslate"><span class="pre">3.0</span> <span class="pre">--&gt;</span> <span class="pre">3.1</span></code>) can be upgraded to without disruption of current clients, because they typically contain non-breaking changes such as adding indexes or changing constraints.</p></li>
<li><p>To upgrade to a major database version (e.g. <code class="docutils literal notranslate"><span class="pre">3.0</span> <span class="pre">--&gt;</span> <span class="pre">4.0</span></code>) without downtime, all clients need to allow the new major version (see table above for details) before the migration is applied.</p></li>
</ul>
<p><strong>Migration playbook:</strong> To avoid downtime, perform database migrations and client upgrades in the following order:</p>
<ol class="arabic simple">
<li><p>Assume we start with clients at redun==0.5.1</p></li>
<li><p>Upgrade db using <code class="docutils literal notranslate"><span class="pre">redun</span> <span class="pre">db</span> <span class="pre">upgrade</span> <span class="pre">3.1</span></code></p></li>
<li><p>Clients can now upgrade to redun==0.6.1</p></li>
<li><p>Upgrade db using <code class="docutils literal notranslate"><span class="pre">redun</span> <span class="pre">db</span> <span class="pre">upgrade</span> <span class="pre">3.2</span></code></p></li>
<li><p>Upgrade db using <code class="docutils literal notranslate"><span class="pre">redun</span> <span class="pre">db</span> <span class="pre">upgrade</span> <span class="pre">3.3</span></code></p></li>
<li><p>Upgrade db using <code class="docutils literal notranslate"><span class="pre">redun</span> <span class="pre">db</span> <span class="pre">upgrade</span> <span class="pre">3.4</span></code></p></li>
<li><p>Clients can now upgrade to redun==0.23.0</p></li>
</ol>
</section>
</section>
<section id="optional-value-store">
<h2>Optional value store<a class="headerlink" href="#optional-value-store" title="Link to this heading">¶</a></h2>
<p>By default, values are stored in the database as BLOB columns.
For most usage patterns, these BLOBs represent the fastest source of growth in the repo.
Users can specify an external key-value store and a minimum size cutoff beyond which values are written to the value store instead of the primary repo.
See <code class="docutils literal notranslate"><span class="pre">ValueStore</span></code> for implementation details.</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="filesystems.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Filesystems</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="config.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Configuration</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, insitro
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Backend and database</a><ul>
<li><a class="reference internal" href="#querying-call-graphs">Querying call graphs</a></li>
<li><a class="reference internal" href="#syncing-provenance-data">Syncing provenance data</a><ul>
<li><a class="reference internal" href="#repositories">Repositories</a></li>
<li><a class="reference internal" href="#running-redun-in-other-repositories">Running redun in other repositories</a></li>
<li><a class="reference internal" href="#synchronizing-repositories">Synchronizing repositories</a></li>
<li><a class="reference internal" href="#manual-exports">Manual exports</a></li>
</ul>
</li>
<li><a class="reference internal" href="#database-migration">Database migration</a><ul>
<li><a class="reference internal" href="#automatic-database-upgrading">Automatic database upgrading</a></li>
<li><a class="reference internal" href="#database-version-capabilities">Database version capabilities</a></li>
<li><a class="reference internal" href="#no-downtime-migrations">No downtime migrations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#optional-value-store">Optional value store</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=46bd48cc"></script>
    </body>
</html>