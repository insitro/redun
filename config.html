<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Backend and database" href="db.html" /><link rel="prev" title="Scheduling redun workflows" href="scheduler.html" />

    <link rel="shortcut icon" href="_static/redun-no-text.svg"/><!-- Generated with Sphinx 7.3.7 and Furo 2024.05.06 -->
        <title>Configuration - redun documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=387cc868" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" /
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">redun  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="_static/redun.svg" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">redun  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">User guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="design.html">Design overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="values.html">Values</a></li>
<li class="toctree-l1"><a class="reference internal" href="tasks.html">Tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="executors.html">Executors</a></li>
<li class="toctree-l1"><a class="reference internal" href="scheduler.html">Scheduling redun workflows</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="db.html">Backend and database</a></li>
<li class="toctree-l1"><a class="reference internal" href="tags.html">Tags</a></li>
<li class="toctree-l1"><a class="reference internal" href="spark.html">Spark</a></li>
<li class="toctree-l1"><a class="reference internal" href="typing.html">Type checking</a></li>
<li class="toctree-l1"><a class="reference internal" href="console.html">Console (TUI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="context.html">Context</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualization.html">Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="FAQ.html">FAQ</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="developing.html">Developer guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="CHANGELOG.html">Changelog</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Implementation notes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="implementation/hashing.html">Content addressable hashing summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="implementation/graph_reduction_caching.html">Graph reduction caching</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="redun/modules.html">API docs</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of API docs</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="redun/redun.html">redun package</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of redun package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="redun/redun.backends.html">redun.backends package</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of redun.backends package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="redun/redun.backends.db.html">redun.backends.db package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="redun/redun.console.html">redun.console package</a></li>
<li class="toctree-l3"><a class="reference internal" href="redun/redun.executors.html">redun.executors package</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/insitro/redun">GitHub repository</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/config.md.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="configuration">
<h1>Configuration<a class="headerlink" href="#configuration" title="Link to this heading">¶</a></h1>
<p>A redun workflow is configured using a configuration file called <code class="docutils literal notranslate"><span class="pre">.redun/redun.ini</span></code> which follows the <a class="reference external" href="https://en.wikipedia.org/wiki/INI_file">INI format</a>). Here is an example:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[backend]</span>
<span class="na">db_uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">sqlite:///redun.db</span>

<span class="k">[executors.default]</span>
<span class="na">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">local</span>
<span class="na">max_workers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">20</span>

<span class="k">[executors.batch]</span>
<span class="na">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">aws_batch</span>
<span class="na">image</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">my-docker-image</span>
<span class="na">queue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">my-aws-batch-queue</span>
<span class="na">s3_scratch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">s3://my-bucket/my-path/</span>
</pre></div>
</div>
<section id="configuration-directory">
<h2>Configuration directory<a class="headerlink" href="#configuration-directory" title="Link to this heading">¶</a></h2>
<p>The configuration directory, <code class="docutils literal notranslate"><span class="pre">.redun/</span></code>, is specified by the following (in order of precedence):</p>
<ul class="simple">
<li><p>Command line option: <code class="docutils literal notranslate"><span class="pre">redun</span> <span class="pre">--config</span> <span class="pre">&lt;config_dir&gt;</span> <span class="pre">...</span></code></p></li>
<li><p>Environment variable: <code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">REDUN_CONFIG=&lt;config_dir&gt;</span></code></p></li>
<li><p>Filesystem search: Find a directory named <code class="docutils literal notranslate"><span class="pre">.redun/</span></code> starting in the current working directory and proceeding to parent directories.</p></li>
<li><p>Lastly, automatically create a configuration directory, <code class="docutils literal notranslate"><span class="pre">.redun/</span></code>, in the current working directory.</p></li>
</ul>
</section>
<section id="configuration-options">
<h2>Configuration options<a class="headerlink" href="#configuration-options" title="Link to this heading">¶</a></h2>
<p>Currently, redun supports the following configuration sections and options.</p>
<section id="scheduler">
<h3>Scheduler<a class="headerlink" href="#scheduler" title="Link to this heading">¶</a></h3>
<p>Scheduler options can be configured in the <code class="docutils literal notranslate"><span class="pre">[scheduler]</span></code> section.</p>
<section id="ignore-warnings">
<h4><code class="docutils literal notranslate"><span class="pre">ignore_warnings</span></code><a class="headerlink" href="#ignore-warnings" title="Link to this heading">¶</a></h4>
<p>A whitespace-separated string of redun warnings to suppress from logging. Current warning types include:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">namespace</span></code>: Task namespaces will be required soon. Until then, it is a warning to not define a namespace for a task.</p></li>
</ul>
</section>
<section id="setup-scheduler">
<h4><code class="docutils literal notranslate"><span class="pre">setup_scheduler</span></code><a class="headerlink" href="#setup-scheduler" title="Link to this heading">¶</a></h4>
<p>A string that specifies the location of a user-defined function for setting up the scheduler. It should follow the syntax <code class="docutils literal notranslate"><span class="pre">{file_or_module}::{function_name}</span></code>, where</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">{file_or_module}</span></code> should be a filename relative to the <code class="docutils literal notranslate"><span class="pre">redun.ini</span></code> file (e.g. <code class="docutils literal notranslate"><span class="pre">../workflow.py</span></code>), or a python module using dot-syntax (e.g. <code class="docutils literal notranslate"><span class="pre">workflow_lib.utils.scheduler</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">{function_name}</span></code> should the name of a function, typically <code class="docutils literal notranslate"><span class="pre">setup_scheduler</span></code>.</p></li>
</ul>
<p>The user function <code class="docutils literal notranslate"><span class="pre">setup_scheduler()</span></code> should take as its first argument <code class="docutils literal notranslate"><span class="pre">config</span></code> (see <a class="reference internal" href="redun/redun.html#redun.config.Config" title="redun.config.Config"><span class="xref myst py py-class">Config</span></a>) and it should return an instantiated <code class="docutils literal notranslate"><span class="pre">scheduler</span></code> (see <a class="reference internal" href="redun/redun.html#redun.scheduler.Scheduler" title="redun.scheduler.Scheduler"><span class="xref myst py py-class">Scheduler</span></a>).</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">redun.config</span> <span class="kn">import</span> <span class="n">Config</span>
<span class="kn">from</span> <span class="nn">redun</span> <span class="kn">import</span> <span class="n">Scheduler</span>

<span class="k">def</span> <span class="nf">setup_scheduler</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">Config</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Scheduler</span><span class="p">:</span>
    <span class="n">scheduler</span> <span class="o">=</span> <span class="n">Scheduler</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>
    <span class="c1"># Perform additional setup such as</span>
    <span class="c1">#   scheduler.add_executor(...)</span>
    <span class="k">return</span> <span class="n">scheduler</span>
</pre></div>
</div>
<p>If <code class="docutils literal notranslate"><span class="pre">setup_scheduler()</span></code> has additional arguments, they are automatically parsed from the command line using <code class="docutils literal notranslate"><span class="pre">--setup</span> <span class="pre">&lt;option&gt;=&lt;value&gt;</span></code>. For example, say we had the following workflow script which supports customizing the executors depending on whether we are in a production or development environment.</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="c1"># workflow.py</span>
<span class="kn">from</span> <span class="nn">redun.config</span> <span class="kn">import</span> <span class="n">Config</span>
<span class="kn">from</span> <span class="nn">redun</span> <span class="kn">import</span> <span class="n">Scheduler</span><span class="p">,</span> <span class="n">task</span>

<span class="kn">from</span> <span class="nn">my_workflow_lib.executors</span> <span class="kn">import</span> <span class="n">ProdExecutor</span><span class="p">,</span> <span class="n">DevExecutor</span>


<span class="n">redun_namespace</span> <span class="o">=</span> <span class="s2">&quot;acme&quot;</span>


<span class="nd">@task</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">main</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="c1"># ...</span>


<span class="k">def</span> <span class="nf">setup_scheduler</span><span class="p">(</span><span class="n">config</span><span class="p">:</span> <span class="n">Config</span><span class="p">,</span> <span class="n">profile</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;prod&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Scheduler</span><span class="p">:</span>
    <span class="n">scheduler</span> <span class="o">=</span> <span class="n">Scheduler</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">profile</span> <span class="o">==</span> <span class="s2">&quot;prod&quot;</span><span class="p">:</span>
        <span class="n">scheduler</span><span class="o">.</span><span class="n">add_executor</span><span class="p">(</span><span class="n">ProdExecutor</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">scheduler</span><span class="o">.</span><span class="n">add_executor</span><span class="p">(</span><span class="n">DevExecutor</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">scheduler</span>
</pre></div>
</div>
<p>We could then call this workflow using:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>redun<span class="w"> </span>--setup<span class="w"> </span><span class="nv">profile</span><span class="o">=</span>dev<span class="w"> </span>run<span class="w"> </span>workflow.py<span class="w"> </span>main<span class="w"> </span>--x<span class="w"> </span><span class="m">1</span><span class="w"> </span>--y<span class="w"> </span><span class="m">2</span>
</pre></div>
</div>
</section>
<section id="job-status-interval">
<h4><code class="docutils literal notranslate"><span class="pre">job_status_interval</span></code><a class="headerlink" href="#job-status-interval" title="Link to this heading">¶</a></h4>
<p>An integer (default: 20) of how many seconds between displays of the job status table.</p>
</section>
<section id="federated-configs">
<h4><code class="docutils literal notranslate"><span class="pre">federated_configs</span></code><a class="headerlink" href="#federated-configs" title="Link to this heading">¶</a></h4>
<p>A config file may mark other config files that should be imported. This is particularly useful
for importing remote config files containing federated entrypoints and their executors.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">scheduler</span><span class="p">]</span>
<span class="n">federated_configs</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">path</span> <span class="n">to</span> <span class="n">config_dir</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">scheduler</span><span class="p">]</span>
<span class="n">federated_configs</span> <span class="o">=</span>
    <span class="o">&lt;</span><span class="n">path</span> <span class="n">to</span> <span class="n">config_dir_1</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">path</span> <span class="n">to</span> <span class="n">config_dir_2</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Only the <code class="docutils literal notranslate"><span class="pre">executor</span></code> and <code class="docutils literal notranslate"><span class="pre">federated_tasks</span></code> from these config file(s) are imported, all other sections
are ignored. There is no namespacing for these imported executors and federated tasks, either
from each other or from the rest of the scheduler’s configuration. Any duplicate names will result
in an error being raised.</p>
</section>
<section id="context">
<h4><code class="docutils literal notranslate"><span class="pre">context</span></code><a class="headerlink" href="#context" title="Link to this heading">¶</a></h4>
<p>Redun’s <a class="reference internal" href="context.html"><span class="doc std std-doc">context</span></a> allows users to specify workflow arguments in the redun.ini config file and then pass those arguments to deeply nested sub-tasks, without having to pass the argument explicitly through all the intermediate tasks along the way.
This is useful for avoiding tedious argument passing (what React developers call “prop-drilling”) and avoids triggering rerunning tasks that don’t even look at such config (they just pass it along).</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[scheduler]</span>
<span class="c1"># Here, we define context variables for our tool, my_tool.</span>
<span class="na">context</span><span class="w"> </span><span class="o">=</span>
<span class="w">  </span><span class="na">{</span>
<span class="w">    </span><span class="na">&quot;my_tool&quot;</span><span class="o">:</span><span class="w"> </span><span class="s">{</span>
<span class="w">      </span><span class="na">&quot;ratio&quot;</span><span class="o">:</span><span class="w"> </span><span class="s">1.618</span>
<span class="w">    </span><span class="na">}</span>
<span class="w">  </span><span class="na">}</span>
</pre></div>
</div>
<p>Then in the task definition, we can access the context variable using the <code class="docutils literal notranslate"><span class="pre">get_context</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@task</span>
<span class="k">def</span> <span class="nf">my_tool</span><span class="p">(</span><span class="n">value</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">ratio</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">get_context</span><span class="p">(</span><span class="s2">&quot;my_tool.ratio&quot;</span><span class="p">))</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="c1"># Perform desired computation with flag set by context.</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Ran my_tool with argument: </span><span class="si">{</span><span class="n">ratio</span><span class="si">}</span><span class="s2">&quot;</span>
</pre></div>
</div>
<p>Context can be overridden with a few CLI flags that can be passed to <code class="docutils literal notranslate"><span class="pre">redun</span> <span class="pre">run</span></code>.
Please use <code class="docutils literal notranslate"><span class="pre">redun</span> <span class="pre">run</span> <span class="pre">-h</span></code> to see the full list of options.</p>
</section>
<section id="context-file">
<h4><code class="docutils literal notranslate"><span class="pre">context_file</span></code><a class="headerlink" href="#context-file" title="Link to this heading">¶</a></h4>
<p>In addition to specifying context inline with the <code class="docutils literal notranslate"><span class="pre">context</span></code> option, users can instead provide a path to the JSON file containing context.
This is useful for large or complex contexts that are easier to manage in a separate file.
The path can be either absolute or relative to the redun config directory (<code class="docutils literal notranslate"><span class="pre">.redun</span></code> by default).</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[scheduler]</span>
<span class="na">context_file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/Users/piotr/context.json</span>
</pre></div>
</div>
</section>
</section>
<section id="backend">
<h3>Backend<a class="headerlink" href="#backend" title="Link to this heading">¶</a></h3>
<p>Backend options, such as connecting to the redun database, can be configured in the <code class="docutils literal notranslate"><span class="pre">[backend]</span></code> section.</p>
<section id="automigrate">
<h4><code class="docutils literal notranslate"><span class="pre">automigrate</span></code><a class="headerlink" href="#automigrate" title="Link to this heading">¶</a></h4>
<p>A bool indicating whether the redun client should automigrate the redun repo database to the latest schema before execution. If the database is a local sqlite file, <code class="docutils literal notranslate"><span class="pre">automigrate</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code> by default for convenience. Otherwise, <code class="docutils literal notranslate"><span class="pre">automation</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code> by default for safety since a central shared database likely needs a coordinated migration.</p>
</section>
<section id="db-aws-secret-name">
<h4><code class="docutils literal notranslate"><span class="pre">db_aws_secret_name</span></code><a class="headerlink" href="#db-aws-secret-name" title="Link to this heading">¶</a></h4>
<p>When specified, the database URI will be constructed from the data stored in the named secret.
<strong>NOTE:</strong> This setting takes precedence over the following backend config options.
If you set this, the <code class="docutils literal notranslate"><span class="pre">db_uri</span></code> and environment variable settings below will be ignored.</p>
<p>This setting assumes the standard fields in an AWS RDS or Other Database secret, namely:</p>
<ul class="simple">
<li><p>engine</p></li>
<li><p>username</p></li>
<li><p>password</p></li>
<li><p>host</p></li>
<li><p>port</p></li>
<li><p>dbname</p></li>
</ul>
</section>
<section id="db-uri">
<h4><code class="docutils literal notranslate"><span class="pre">db_uri</span></code><a class="headerlink" href="#db-uri" title="Link to this heading">¶</a></h4>
<p><a class="reference external" href="https://docs.sqlalchemy.org/en/13/core/engines.html#database-urls">URI</a> for the redun database. redun supports the <code class="docutils literal notranslate"><span class="pre">sqlite</span></code> and <code class="docutils literal notranslate"><span class="pre">postgresql</span></code> protocols. If the URI is relative, it will be interpreted as relative to the configuration directory, <code class="docutils literal notranslate"><span class="pre">.redun/</span></code>.</p>
<p>For security reasons, username and password are not allowed in <code class="docutils literal notranslate"><span class="pre">db_uri</span></code>, since <code class="docutils literal notranslate"><span class="pre">redun.ini</span></code> files are often checked into source control. See below for alternative ways to define database credentials.</p>
</section>
<section id="db-username-env">
<h4><code class="docutils literal notranslate"><span class="pre">db_username_env</span></code><a class="headerlink" href="#db-username-env" title="Link to this heading">¶</a></h4>
<p>Environment variable (default: <code class="docutils literal notranslate"><span class="pre">REDUN_DB_USERNAME</span></code>) containing the username login for <code class="docutils literal notranslate"><span class="pre">db_uri</span></code>.</p>
</section>
<section id="db-password-env">
<h4><code class="docutils literal notranslate"><span class="pre">db_password_env</span></code><a class="headerlink" href="#db-password-env" title="Link to this heading">¶</a></h4>
<p>Environment variable (default: <code class="docutils literal notranslate"><span class="pre">REDUN_DB_PASSWORD</span></code>) containing the password login for <code class="docutils literal notranslate"><span class="pre">db_uri</span></code>.</p>
</section>
<section id="max-value-size">
<h4><code class="docutils literal notranslate"><span class="pre">max_value_size</span></code><a class="headerlink" href="#max-value-size" title="Link to this heading">¶</a></h4>
<p>An integer (default: <code class="docutils literal notranslate"><span class="pre">1000000000</span></code>, 1Gb) specifying the maximum number of bytes to allow for storing a single value in the cache.</p>
</section>
<section id="value-store-path">
<h4><code class="docutils literal notranslate"><span class="pre">value_store_path</span></code><a class="headerlink" href="#value-store-path" title="Link to this heading">¶</a></h4>
<p>Location of an optional <code class="docutils literal notranslate"><span class="pre">ValueStore</span></code>.
If a local, non-absolute path is specified, it is assumed relative to <code class="docutils literal notranslate"><span class="pre">config_dir</span></code>.</p>
</section>
<section id="value-store-min-size">
<h4><code class="docutils literal notranslate"><span class="pre">value_store_min_size</span></code><a class="headerlink" href="#value-store-min-size" title="Link to this heading">¶</a></h4>
<p>Minimum value size in bytes beyond which values are written to the value store instead of the primary backend.</p>
</section>
</section>
<section id="limits">
<h3>Limits<a class="headerlink" href="#limits" title="Link to this heading">¶</a></h3>
<p>redun supports limiting the parallelism of tasks using resource limits, similar to other workflow engines like <a class="reference external" href="https://luigi.readthedocs.io/en/stable/configuration.html#resources-config">Luigi</a>. For example, the following configuration:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[limits]</span>
<span class="na">db</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">10</span>
<span class="na">web_api</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">5</span>
</pre></div>
</div>
<p>specifies two resource limits <code class="docutils literal notranslate"><span class="pre">db</span></code> and <code class="docutils literal notranslate"><span class="pre">web_api</span></code> with available amounts of 10 and 5, respectively. Users can specify that certain tasks require a resource using the <code class="docutils literal notranslate"><span class="pre">limit</span></code> task option:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="nd">@task</span><span class="p">(</span><span class="n">limits</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;db&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">read_from_database</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="c1"># ...</span>
</pre></div>
</div>
<p>Every time the task <code class="docutils literal notranslate"><span class="pre">read_from_database</span></code> is executing, it consumes one unit of resource <code class="docutils literal notranslate"><span class="pre">db</span></code>. It releases its resource when the task completes. This limit allows users to define a maximum concurrency on a per task or resource basis, which is useful for preventing overloading databases or APIs with too many concurrent connections.</p>
<p>Tasks may specify multiple resources within the <code class="docutils literal notranslate"><span class="pre">limits</span></code> list. Tasks may also consume multiples of a resource by specifying <code class="docutils literal notranslate"><span class="pre">limits</span></code> with a <code class="docutils literal notranslate"><span class="pre">dict</span></code>:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="nd">@task</span><span class="p">(</span><span class="n">limits</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;db&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="k">def</span> <span class="nf">read_from_database</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="c1"># ...</span>
</pre></div>
</div>
<p>In the above example, <code class="docutils literal notranslate"><span class="pre">read_from_database()</span></code> consumes 2 units of the resource <code class="docutils literal notranslate"><span class="pre">db</span></code> for each running task.</p>
</section>
<section id="executors">
<h3>Executors<a class="headerlink" href="#executors" title="Link to this heading">¶</a></h3>
<p>redun is able to perform task execution across various compute infrastructure using modules call <a class="reference internal" href="executors.html"><span class="doc std std-doc">Executors</span></a>. Each executor has its own configuration options.</p>
<p>Executors are defined using a section with the format <code class="docutils literal notranslate"><span class="pre">executor.{executor_name}</span></code>, where <code class="docutils literal notranslate"><span class="pre">{executor_name}</span></code> is a user-specific name for the executor, such as <code class="docutils literal notranslate"><span class="pre">default</span></code> or <code class="docutils literal notranslate"><span class="pre">batch</span></code>. The executor module is specified by the option <code class="docutils literal notranslate"><span class="pre">type</span></code>. For example, we can configure a local executor with name <code class="docutils literal notranslate"><span class="pre">local_exec</span></code> and 20 maximum threads using:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[executors.local_exec]</span>
<span class="na">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">local</span>
<span class="na">max_workers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">20</span>
</pre></div>
</div>
<p>Within a workflow, users can specify which tasks should execute on this executor using the <code class="docutils literal notranslate"><span class="pre">executor</span></code> task option:</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="nd">@task</span><span class="p">(</span><span class="n">executor</span><span class="o">=</span><span class="s2">&quot;local_exec&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">task1</span><span class="p">():</span>
    <span class="c1"># ...</span>
</pre></div>
</div>
<section id="type">
<h4><code class="docutils literal notranslate"><span class="pre">type</span></code><a class="headerlink" href="#type" title="Link to this heading">¶</a></h4>
<p>A string that specifies the executor module (e.g. <code class="docutils literal notranslate"><span class="pre">local</span></code>, <code class="docutils literal notranslate"><span class="pre">aws_batch</span></code>, etc) to use for this executor.</p>
</section>
<section id="local-executor">
<h4>Local executor<a class="headerlink" href="#local-executor" title="Link to this heading">¶</a></h4>
<p>The <a class="reference internal" href="executors.html#local-executor"><span class="std std-ref">Local executor</span></a> (<code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">=</span> <span class="pre">local</span></code>) executes tasks on the local machine using either multiple threads or processes.</p>
<section id="mode">
<h5><code class="docutils literal notranslate"><span class="pre">mode</span></code><a class="headerlink" href="#mode" title="Link to this heading">¶</a></h5>
<p>A string (default: <code class="docutils literal notranslate"><span class="pre">thread</span></code>) that specifies whether to run tasks on new threads (<code class="docutils literal notranslate"><span class="pre">mode</span> <span class="pre">=</span> <span class="pre">thread</span></code>) or new processes (<code class="docutils literal notranslate"><span class="pre">mode</span> <span class="pre">=</span> <span class="pre">process</span></code>).</p>
</section>
<section id="max-workers">
<h5><code class="docutils literal notranslate"><span class="pre">max_workers</span></code><a class="headerlink" href="#max-workers" title="Link to this heading">¶</a></h5>
<p>An integer (default: 20) that specifies the maximum number of workers to use in the thread/process pool for task execution.</p>
</section>
<section id="start-method">
<h5><code class="docutils literal notranslate"><span class="pre">start_method</span></code><a class="headerlink" href="#start-method" title="Link to this heading">¶</a></h5>
<p>A string (default: <code class="docutils literal notranslate"><span class="pre">fork</span></code>) that specifies the <a class="reference external" href="https://docs.python.org/3/library/multiprocessing.html#contexts-and-start-methods">start method</a> for new processes. Other start methods include <code class="docutils literal notranslate"><span class="pre">spawn</span></code> and <code class="docutils literal notranslate"><span class="pre">forkserver</span></code>.</p>
</section>
</section>
<section id="alias-executor">
<h4>Alias executor<a class="headerlink" href="#alias-executor" title="Link to this heading">¶</a></h4>
<p>The <a class="reference internal" href="executors.html#alias-executor"><span class="std std-ref">Alias executor</span></a> (<code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">=</span> <span class="pre">alias</span></code>) is a “symlink” to
another underlying executor.</p>
<section id="target">
<h5><code class="docutils literal notranslate"><span class="pre">target</span></code><a class="headerlink" href="#target" title="Link to this heading">¶</a></h5>
<p>A string containing the  name of another executor to defer to. It is lazily resolved
at execution time.</p>
</section>
</section>
<section id="docker-executor">
<h4>Docker executor<a class="headerlink" href="#docker-executor" title="Link to this heading">¶</a></h4>
<section id="image">
<h5><code class="docutils literal notranslate"><span class="pre">image</span></code><a class="headerlink" href="#image" title="Link to this heading">¶</a></h5>
<p>A string that specifies the default Docker image. This can be overridden on a per task basis using task options.</p>
</section>
<section id="scratch">
<h5><code class="docutils literal notranslate"><span class="pre">scratch</span></code><a class="headerlink" href="#scratch" title="Link to this heading">¶</a></h5>
<p>A string that specifies the scratch path to volume mount for communicating with the Docker container. If the path is relative, it is interpreted to be relative to the redun configuration directory (e.g. <code class="docutils literal notranslate"><span class="pre">.redun/</span></code>).</p>
</section>
<section id="vcpus">
<h5><code class="docutils literal notranslate"><span class="pre">vcpus</span></code><a class="headerlink" href="#vcpus" title="Link to this heading">¶</a></h5>
<p>An integer (default: 1) that specifies the default number of virtual CPUs required for each task. This can be overridden on a per task basis using task options.</p>
</section>
<section id="gpus">
<h5><code class="docutils literal notranslate"><span class="pre">gpus</span></code><a class="headerlink" href="#gpus" title="Link to this heading">¶</a></h5>
<p>An integer (default: 0) that specifies the default number of GPUs required for each task. This can be overridden on a per task basis using task options.</p>
</section>
<section id="memory">
<h5><code class="docutils literal notranslate"><span class="pre">memory</span></code><a class="headerlink" href="#memory" title="Link to this heading">¶</a></h5>
<p>A float (default: 4) that specifies the default amount of memory (in Gb) required for each task. This can be overridden on a per task basis using task options.</p>
</section>
<section id="interactive">
<h5><code class="docutils literal notranslate"><span class="pre">interactive</span></code><a class="headerlink" href="#interactive" title="Link to this heading">¶</a></h5>
<p>A bool (default: False) that specifies whether the Docker container should be run in interactive mode. This is useful for debugging a workflow since the stdout of every container will be redirected to the terminal.</p>
</section>
<section id="volumes">
<h5><code class="docutils literal notranslate"><span class="pre">volumes</span></code><a class="headerlink" href="#volumes" title="Link to this heading">¶</a></h5>
<p>A JSON list of pairs that specifies <a class="reference external" href="https://docs.docker.com/storage/volumes/">Docker volume mounts</a>. Each pair is a host and container path. For example, the following syntax is used to mount <code class="docutils literal notranslate"><span class="pre">/tmp/data</span></code> and <code class="docutils literal notranslate"><span class="pre">/tmp/data2</span></code> host directories to <code class="docutils literal notranslate"><span class="pre">/workflow/data</span></code> and <code class="docutils literal notranslate"><span class="pre">/workflow/data2</span></code> container directories, respectively.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">volumes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">[[&quot;/tmp/data&quot;, &quot;/workflow/data&quot;], [&quot;/tmp/data2&quot;, &quot;/workflow/data2&quot;]]</span>
</pre></div>
</div>
<p>If host paths are relative, they are assumed relative to the configuration directory (e.g. <code class="docutils literal notranslate"><span class="pre">.redun</span></code>).</p>
</section>
</section>
<section id="aws-batch-executor">
<h4>AWS Batch executor<a class="headerlink" href="#aws-batch-executor" title="Link to this heading">¶</a></h4>
<p>The <a class="reference internal" href="executors.html#aws-batch-executor"><span class="std std-ref">AWS Batch executor</span></a> (<code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">=</span> <span class="pre">aws_batch</span></code>) executes tasks on the AWS Batch compute service.</p>
<section id="id1">
<h5><code class="docutils literal notranslate"><span class="pre">image</span></code><a class="headerlink" href="#id1" title="Link to this heading">¶</a></h5>
<p>A string that specifies the default Docker image to use for AWS Batch jobs. This can be overridden on a per task basis using task options.</p>
</section>
<section id="queue">
<h5><code class="docutils literal notranslate"><span class="pre">queue</span></code><a class="headerlink" href="#queue" title="Link to this heading">¶</a></h5>
<p>A string that specifies the default AWS Batch queue to use for submitting jobs. This can be overridden on a per task basis using task options.</p>
</section>
<section id="s3-scratch">
<h5><code class="docutils literal notranslate"><span class="pre">s3_scratch</span></code><a class="headerlink" href="#s3-scratch" title="Link to this heading">¶</a></h5>
<p>A string that specifies the <a class="reference internal" href="executors.html#s3-scratch-space"><span class="std std-ref">S3 scratch space</span></a> used to communicate with AWS Batch jobs.</p>
</section>
<section id="aws-region">
<h5><code class="docutils literal notranslate"><span class="pre">aws_region</span></code><a class="headerlink" href="#aws-region" title="Link to this heading">¶</a></h5>
<p>A string that specifies the AWS region containing the user’s AWS Batch service.</p>
</section>
<section id="role">
<h5><code class="docutils literal notranslate"><span class="pre">role</span></code><a class="headerlink" href="#role" title="Link to this heading">¶</a></h5>
<p>A string (default: the AWS account’s <code class="docutils literal notranslate"><span class="pre">ecsTaskExecutionRole</span></code>) that specifies the ARN of the IAM role that AWS Batch jobs should adopt while executing. This may be needed for jobs to have proper access to resources (S3 data, other services, etc). This can be overridden on a per task basis using task options. To disable setting a role on the job definition use <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<p>This key is mapped to the <a class="reference external" href="https://docs.aws.amazon.com/batch/latest/userguide/job_definition_parameters.html#containerProperties"><code class="docutils literal notranslate"><span class="pre">jobRoleArn</span></code> property</a> of the Batch API.</p>
</section>
<section id="id2">
<h5><code class="docutils literal notranslate"><span class="pre">vcpus</span></code><a class="headerlink" href="#id2" title="Link to this heading">¶</a></h5>
<p>An integer (default: 1) that specifies the default number of virtual CPUs required for each task. This can be overridden on a per task basis using task options.</p>
</section>
<section id="id3">
<h5><code class="docutils literal notranslate"><span class="pre">gpus</span></code><a class="headerlink" href="#id3" title="Link to this heading">¶</a></h5>
<p>An integer (default: 0) that specifies the default number of GPUs required for each task. This can be overridden on a per task basis using task options.</p>
</section>
<section id="id4">
<h5><code class="docutils literal notranslate"><span class="pre">memory</span></code><a class="headerlink" href="#id4" title="Link to this heading">¶</a></h5>
<p>A float (default: 4) that specifies the default amount of memory (in Gb) required for each task. This can be overridden on a per task basis using task options.</p>
</section>
<section id="retries">
<h5><code class="docutils literal notranslate"><span class="pre">retries</span></code><a class="headerlink" href="#retries" title="Link to this heading">¶</a></h5>
<p>An integer (default: 1) that specifies the default number of retries to use for submitting a job to the AWS Batch queue. This can be overridden on a per task basis using task options.</p>
</section>
<section id="job-name-prefix">
<h5><code class="docutils literal notranslate"><span class="pre">job_name_prefix</span></code><a class="headerlink" href="#job-name-prefix" title="Link to this heading">¶</a></h5>
<p>A string (default: <code class="docutils literal notranslate"><span class="pre">batch-job</span></code>) that specifies the prefix to use for AWS Batch job names. This can make it easier for users to distinguish which AWS Batch jobs correspond to their workflow.</p>
</section>
<section id="code-package">
<h5><code class="docutils literal notranslate"><span class="pre">code_package</span></code><a class="headerlink" href="#code-package" title="Link to this heading">¶</a></h5>
<p>A bool (default: True) that specifies whether to perform <a class="reference internal" href="executors.html#code-packaging"><span class="std std-ref">code packaging</span></a>.</p>
</section>
<section id="code-includes">
<h5><code class="docutils literal notranslate"><span class="pre">code_includes</span></code><a class="headerlink" href="#code-includes" title="Link to this heading">¶</a></h5>
<p>A string (default: <code class="docutils literal notranslate"><span class="pre">**/*.py</span></code>) that specifies a pattern for which files should be included in a <a class="reference internal" href="executors.html#code-packaging"><span class="std std-ref">code package</span></a>. Multiple patterns can be specified separated by whitespace. Whitespace can be escaped using <a class="reference external" href="https://docs.python.org/3/library/shlex.html#shlex.split">shell-like syntax</a></p>
</section>
<section id="code-excludes">
<h5><code class="docutils literal notranslate"><span class="pre">code_excludes</span></code><a class="headerlink" href="#code-excludes" title="Link to this heading">¶</a></h5>
<p>A string (default: None) that specifies a pattern for which files should be excluded from a <a class="reference internal" href="executors.html#code-packaging"><span class="std std-ref">code package</span></a>. Multiple patterns can be specified separated by whitespace. Whitespace can be escaped using <a class="reference external" href="https://docs.python.org/3/library/shlex.html#shlex.split">shell-like syntax</a></p>
</section>
<section id="debug">
<h5><code class="docutils literal notranslate"><span class="pre">debug</span></code><a class="headerlink" href="#debug" title="Link to this heading">¶</a></h5>
<p>A bool (default: False) that specifies whether to run the <a class="reference internal" href="executors.html#local-debugging"><span class="std std-ref">Docker container locally</span></a>.</p>
</section>
<section id="job-monitor-interval">
<h5><code class="docutils literal notranslate"><span class="pre">job_monitor_interval</span></code><a class="headerlink" href="#job-monitor-interval" title="Link to this heading">¶</a></h5>
<p>A float (default: 5.0) that specifies how often, in seconds, the AWS Batch API is queried to monitor running jobs.</p>
</section>
<section id="min-array-size">
<h5><code class="docutils literal notranslate"><span class="pre">min_array_size</span></code><a class="headerlink" href="#min-array-size" title="Link to this heading">¶</a></h5>
<p>Minimum number (default: 5) of equivalent tasks that will be submitted together as an AWS Batch array job. “Equivalent” means the same task and execution requirements (CPU, memory, etc), but with possibly different arguments. Set to 0 to disable array job submission. Defaults to 5.</p>
</section>
<section id="max-array-size">
<h5><code class="docutils literal notranslate"><span class="pre">max_array_size</span></code><a class="headerlink" href="#max-array-size" title="Link to this heading">¶</a></h5>
<p>Maximum number (default: 1000) of equivalent tasks that will be submitted together as an AWS Batch array job. Must be greater than or equal to <code class="docutils literal notranslate"><span class="pre">min_array_size</span></code>. If greater than the AWS maximum array size (currently 10000), will be clamped to this value.</p>
</section>
<section id="job-stale-time">
<h5><code class="docutils literal notranslate"><span class="pre">job_stale_time</span></code><a class="headerlink" href="#job-stale-time" title="Link to this heading">¶</a></h5>
<p>A float (default: 3.0) that specifies the maximum time, in seconds, jobs will wait before submission to be possibly bundled into an array job.</p>
</section>
<section id="timeout">
<h5><code class="docutils literal notranslate"><span class="pre">timeout</span></code><a class="headerlink" href="#timeout" title="Link to this heading">¶</a></h5>
<p>An optional integer (default: None) that specifies the time duration in seconds (measure from job attempt’s <code class="docutils literal notranslate"><span class="pre">startedAt</span></code> timestamp) after which AWS Batch will terminate the job. For more on job timeouts, see the <a class="reference external" href="https://docs.aws.amazon.com/batch/latest/userguide/job_timeouts.html">Job Timeouts on Batch docs</a>. When not set, jobs will run indefinitely (unless on Fargate where there is a 14 day limit).</p>
</section>
<section id="privileged">
<h5><code class="docutils literal notranslate"><span class="pre">privileged</span></code><a class="headerlink" href="#privileged" title="Link to this heading">¶</a></h5>
<p>An optional bool (default: False) that specifies whether to run the job in privileged mode.</p>
</section>
<section id="autocreate-job-def">
<h5><code class="docutils literal notranslate"><span class="pre">autocreate_job_def</span></code><a class="headerlink" href="#autocreate-job-def" title="Link to this heading">¶</a></h5>
<p>An optional bool (default: True). If <code class="docutils literal notranslate"><span class="pre">autocreate_job_def</span></code> is disabled, then we require a <code class="docutils literal notranslate"><span class="pre">job_def_name</span></code>
to be present and lookup the job by name. If <code class="docutils literal notranslate"><span class="pre">autocreate_job_def</span></code> is enabled, then we will create
a new job definition if an existing one matching <code class="docutils literal notranslate"><span class="pre">job_def_name</span></code> and required properties cannot be found.
For backwards-compatibility, the deprecated <code class="docutils literal notranslate"><span class="pre">autocreate_job</span></code> is also supported.</p>
</section>
<section id="job-def-name">
<h5><code class="docutils literal notranslate"><span class="pre">job_def_name</span></code><a class="headerlink" href="#job-def-name" title="Link to this heading">¶</a></h5>
<p>An optional str (default: None) that specifies a job definition to use. If not set, a new job definition will created.</p>
</section>
<section id="batch-tags">
<h5><code class="docutils literal notranslate"><span class="pre">batch_tags</span></code><a class="headerlink" href="#batch-tags" title="Link to this heading">¶</a></h5>
<p>An optional JSON mapping of string key-value pairs to use as Batch job tags. This could be used to track jobs or query them after execution.</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="na">batch_tags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">{&quot;project&quot;: &quot;acme&quot;, &quot;user&quot;: &quot;alice&quot;}</span>
</pre></div>
</div>
</section>
<section id="default-batch-tags">
<h5><code class="docutils literal notranslate"><span class="pre">default_batch_tags</span></code><a class="headerlink" href="#default-batch-tags" title="Link to this heading">¶</a></h5>
<p>A bool (default: True) that specifies whether redun should add default tags to all batch jobs. The default tags include:</p>
<ul class="simple">
<li><p>redun_job_id: id of the redun Job.</p></li>
<li><p>redun_task_name: fullname of the redun Task.</p></li>
<li><p>redun_execution_id: id of the high-level execution for the whole workflow.</p></li>
<li><p>redun_project: the project of the workflow, which is typically the root task namespace.</p></li>
<li><p>redun_aws_user: the user as identified by sts.get_caller_identity.</p></li>
</ul>
</section>
<section id="num-nodes">
<h5><code class="docutils literal notranslate"><span class="pre">num_nodes</span></code><a class="headerlink" href="#num-nodes" title="Link to this heading">¶</a></h5>
<p>If not none, use a multi-node job and set the number of workers.</p>
</section>
<section id="job-def-extra">
<h5><code class="docutils literal notranslate"><span class="pre">job_def_extra</span></code><a class="headerlink" href="#job-def-extra" title="Link to this heading">¶</a></h5>
<p>Dictionary of additional arguments to pass to AWS Batch job definition creation. Parameters are documented
<a class="reference external" href="https://docs.aws.amazon.com/batch/latest/userguide/job_definition_parameters.html">here</a>. Only the specified
keys will be changed - any other options set elsewhere by redun (such as ulimit for multi-node jobs, etc)
will remain set.</p>
<p>For example, to allocate 100 MiB of swap space:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">job_def_extra</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;containerProperties&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;linuxParameters&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;maxSwap&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="s2">&quot;swappiness&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}}}</span>
</pre></div>
</div>
</section>
</section>
<section id="aws-glue-executor">
<h4>AWS Glue executor<a class="headerlink" href="#aws-glue-executor" title="Link to this heading">¶</a></h4>
<p>The <a class="reference internal" href="executors.html#aws-glue-spark-executor"><span class="std std-ref">AWS Glue executor</span></a> (<code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">=</span> <span class="pre">aws_glue</span></code>) executes tasks on the AWS Glue compute service.</p>
<section id="id5">
<h5><code class="docutils literal notranslate"><span class="pre">s3_scratch</span></code><a class="headerlink" href="#id5" title="Link to this heading">¶</a></h5>
<p>A string that specifies the <a class="reference internal" href="executors.html#s3-scratch-space"><span class="std std-ref">S3 scratch space</span></a> used to communicate with AWS Glue jobs.</p>
</section>
<section id="workers">
<h5><code class="docutils literal notranslate"><span class="pre">workers</span></code><a class="headerlink" href="#workers" title="Link to this heading">¶</a></h5>
<p>An integer that specifies the number of workers available by default to Glue jobs. Each worker provides one or more “data processing units” (DPUs). AWS defines a  DPU as “a relative measure of processing power that consists of 4 vCPUs of compute capacity and 16GB of memory.” Depending on the worker type, there will be one or more Spark executors per DPU, each with one or more spark cores. Jobs are billed by number of DPUs and time. This parameter can be overridden on a per-task basis using task options.</p>
</section>
<section id="worker-type">
<h5><code class="docutils literal notranslate"><span class="pre">worker_type</span></code><a class="headerlink" href="#worker-type" title="Link to this heading">¶</a></h5>
<p>Choose from:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Standard</span></code>: each worker will have a 50GB disk scratch space and 2 executors, each with 4 vCPU cores.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">G.1X</span></code>: each worker maps to 1 DPU and a single executor, with 8 vCPU cores and 10 GiB of memory. AWS recommends
this worker type for memory-intensive jobs.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">G.2X</span></code>: each worker maps to 2 DPUs and a single executor, with 16 vCPU cores and 24576 MiB of memory. AWS recommends
this worker type for memory-intensive jobs or ML transforms. Note that as this worker type provides 2 DPUs, it is twice
as expensive as the others.</p></li>
</ul>
<p>This can be overridden on a per-task basis using task options.</p>
</section>
<section id="id6">
<h5><code class="docutils literal notranslate"><span class="pre">aws_region</span></code><a class="headerlink" href="#id6" title="Link to this heading">¶</a></h5>
<p>A string that specifies the AWS region containing the user’s AWS Glue service.</p>
</section>
<section id="id7">
<h5><code class="docutils literal notranslate"><span class="pre">role</span></code><a class="headerlink" href="#id7" title="Link to this heading">¶</a></h5>
<p>A string (default: your account’s <code class="docutils literal notranslate"><span class="pre">AWSGlueServiceRole</span></code>) that specifies the ARN of the IAM role that AWS Glue jobs should adopt while executing. AWS provides a <a class="reference external" href="https://docs.aws.amazon.com/glue/latest/dg/create-service-policy.html">managed policy</a>, <code class="docutils literal notranslate"><span class="pre">AWSGlueServiceRole</span></code> that has the minimal permissions to run glue jobs, but you may need to provide access to S3 or other resources.</p>
<p>This key is mapped to the <a class="reference external" href="https://docs.aws.amazon.com/glue/latest/dg/aws-glue-api-jobs-job.html"><code class="docutils literal notranslate"><span class="pre">Role</span></code> property</a> of the Glue API.</p>
</section>
<section id="glue-job-prefix">
<h5><code class="docutils literal notranslate"><span class="pre">glue_job_prefix</span></code><a class="headerlink" href="#glue-job-prefix" title="Link to this heading">¶</a></h5>
<p>A string specifying the prefix for Glue job definitions created and used by redun. Defaults to <code class="docutils literal notranslate"><span class="pre">REDUN</span></code>.</p>
</section>
<section id="spark-history-dir">
<h5><code class="docutils literal notranslate"><span class="pre">spark_history_dir</span></code><a class="headerlink" href="#spark-history-dir" title="Link to this heading">¶</a></h5>
<p>String specifying an S3 path to the location where Spark will log history information that can be used by a
Spark History Server to visualize and monitor job progress. Defaults to <code class="docutils literal notranslate"><span class="pre">f&quot;{s3_scratch_path}/glue/spark_history&quot;</span></code></p>
</section>
<section id="id8">
<h5><code class="docutils literal notranslate"><span class="pre">job_monitor_interval</span></code><a class="headerlink" href="#id8" title="Link to this heading">¶</a></h5>
<p>Float specifying how frequently to query AWS for the status of running Glue jobs. Defaults to 10.0 seconds.</p>
</section>
<section id="job-retry-interval">
<h5><code class="docutils literal notranslate"><span class="pre">job_retry_interval</span></code><a class="headerlink" href="#job-retry-interval" title="Link to this heading">¶</a></h5>
<p>Float specifying how frequently to retry submitting Glue jobs that were not able to be started due to resource
constraints. Five attempts will be made to submit pending jobs, and then the retry period will pass. Defaults
to 60.0 seconds.</p>
</section>
<section id="id9">
<h5><code class="docutils literal notranslate"><span class="pre">timeout</span></code><a class="headerlink" href="#id9" title="Link to this heading">¶</a></h5>
<p>Integer number of minutes to run jobs before they are killed. Defaults to 2880 (48 hours). Useful for preventing
cost overruns.</p>
</section>
<section id="id10">
<h5><code class="docutils literal notranslate"><span class="pre">code_package</span></code><a class="headerlink" href="#id10" title="Link to this heading">¶</a></h5>
<p>A bool (default: True) that specifies whether to perform <a class="reference internal" href="executors.html#code-packaging"><span class="std std-ref">code packaging</span></a>.</p>
</section>
<section id="id11">
<h5><code class="docutils literal notranslate"><span class="pre">code_includes</span></code><a class="headerlink" href="#id11" title="Link to this heading">¶</a></h5>
<p>A string (default: <code class="docutils literal notranslate"><span class="pre">**/*.py</span></code>) that specifies a pattern for which files should be included in a <a class="reference internal" href="executors.html#code-packaging"><span class="std std-ref">code package</span></a>. Multiple patterns can be specified separated by whitespace. Whitespace can be escaped using <a class="reference external" href="https://docs.python.org/3/library/shlex.html#shlex.split">shell-like syntax</a></p>
</section>
<section id="id12">
<h5><code class="docutils literal notranslate"><span class="pre">code_excludes</span></code><a class="headerlink" href="#id12" title="Link to this heading">¶</a></h5>
<p>A string (default: None) that specifies a pattern for which files should be excluded from a <a class="reference internal" href="executors.html#code-packaging"><span class="std std-ref">code package</span></a>. Multiple patterns can be specified separated by whitespace. Whitespace can be escaped using <a class="reference external" href="https://docs.python.org/3/library/shlex.html#shlex.split">shell-like syntax</a></p>
</section>
</section>
</section>
<section id="federated-tasks">
<h3>Federated tasks<a class="headerlink" href="#federated-tasks" title="Link to this heading">¶</a></h3>
<p>The following config keys are required. All other data is passed to the <code class="docutils literal notranslate"><span class="pre">subrun</span></code> that
implements the bulk of the federated task behavior, hence they are either consumed by <code class="docutils literal notranslate"><span class="pre">subrun</span></code> directly or
are set as task options.</p>
<section id="namespace">
<h4><code class="docutils literal notranslate"><span class="pre">namespace</span></code><a class="headerlink" href="#namespace" title="Link to this heading">¶</a></h4>
<p>The namespace of the federated task.</p>
</section>
<section id="task-name">
<h4><code class="docutils literal notranslate"><span class="pre">task_name</span></code><a class="headerlink" href="#task-name" title="Link to this heading">¶</a></h4>
<p>The name of the federated task.</p>
</section>
<section id="load-module">
<h4><code class="docutils literal notranslate"><span class="pre">load_module</span></code><a class="headerlink" href="#load-module" title="Link to this heading">¶</a></h4>
<p>The name of the module to load, which will ensure that the above task is actually defined.</p>
</section>
<section id="executor">
<h4><code class="docutils literal notranslate"><span class="pre">executor</span></code><a class="headerlink" href="#executor" title="Link to this heading">¶</a></h4>
<p>The name of the executor that has the execution context for this federated task.</p>
</section>
<section id="config-dir">
<h4><code class="docutils literal notranslate"><span class="pre">config_dir</span></code><a class="headerlink" href="#config-dir" title="Link to this heading">¶</a></h4>
<p>The path to the configuration to use for the remainder of the execution. Either an absolute
path or relative to the executor entrypoint.</p>
</section>
<section id="task-signature">
<h4><code class="docutils literal notranslate"><span class="pre">task_signature</span></code><a class="headerlink" href="#task-signature" title="Link to this heading">¶</a></h4>
<p>Optional. The signature of the federated task. Because the task options can be used to change the name of the task itself, task_name <em>and</em> task_signature are separate options in the config.</p>
</section>
<section id="description">
<h4><code class="docutils literal notranslate"><span class="pre">description</span></code><a class="headerlink" href="#description" title="Link to this heading">¶</a></h4>
<p>Optional. A description of this entrypoint.</p>
</section>
<section id="kubernetes-k8s-executor">
<h4>Kubernetes (k8s) executor<a class="headerlink" href="#kubernetes-k8s-executor" title="Link to this heading">¶</a></h4>
<p>The <a class="reference internal" href="executors.html#kubernetes-k8s-executor"><span class="std std-ref">Kubernetes executor</span></a> (<code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">=</span> <span class="pre">k8s</span></code>) executes tasks on a Kubernetes cluster.</p>
<section id="id13">
<h5><code class="docutils literal notranslate"><span class="pre">image</span></code><a class="headerlink" href="#id13" title="Link to this heading">¶</a></h5>
<p>A string that specifies the default Docker image. This can be overridden on a per task basis using task options.</p>
</section>
<section id="id14">
<h5><code class="docutils literal notranslate"><span class="pre">scratch</span></code><a class="headerlink" href="#id14" title="Link to this heading">¶</a></h5>
<p>A string that specifies the <a class="reference internal" href="executors.html#s3-scratch-space"><span class="std std-ref">scratch space</span></a> used to communicate with k8s jobs. This can be a path on any accessible object storage system (e.g. S3, GCS, etc).</p>
</section>
<section id="id15">
<h5><code class="docutils literal notranslate"><span class="pre">namespace</span></code><a class="headerlink" href="#id15" title="Link to this heading">¶</a></h5>
<p>A string (default: <code class="docutils literal notranslate"><span class="pre">default</span></code>) that specifies the k8s namespace to use for all resources.</p>
</section>
<section id="secret-name">
<h5><code class="docutils literal notranslate"><span class="pre">secret_name</span></code><a class="headerlink" href="#secret-name" title="Link to this heading">¶</a></h5>
<p>An optional string that specifies the name of a k8s secret to use for passing AWS secrets.</p>
</section>
<section id="import-aws-secrets">
<h5><code class="docutils literal notranslate"><span class="pre">import_aws_secrets</span></code><a class="headerlink" href="#import-aws-secrets" title="Link to this heading">¶</a></h5>
<p>A bool (default: True) that specifies whether to import the local AWS environment variable secrets into the k8s jobs via a k8s secret (see <code class="docutils literal notranslate"><span class="pre">secret_name</span></code>).</p>
</section>
<section id="secret-env-vars">
<h5><code class="docutils literal notranslate"><span class="pre">secret_env_vars</span></code><a class="headerlink" href="#secret-env-vars" title="Link to this heading">¶</a></h5>
<p>A whitespace separated list of environment variables to import into the k8s jobs via a k8s secret (see <code class="docutils literal notranslate"><span class="pre">secret_name</span></code>).</p>
</section>
<section id="id16">
<h5><code class="docutils literal notranslate"><span class="pre">vcpus</span></code><a class="headerlink" href="#id16" title="Link to this heading">¶</a></h5>
<p>An integer (default: 1) that specifies the default number of virtual CPUs required for each task. This can be overridden on a per task basis using task options.</p>
</section>
<section id="id17">
<h5><code class="docutils literal notranslate"><span class="pre">memory</span></code><a class="headerlink" href="#id17" title="Link to this heading">¶</a></h5>
<p>A float (default: 4) that specifies the default amount of memory (in Gb) required for each task. This can be overridden on a per task basis using task options.</p>
</section>
<section id="id18">
<h5><code class="docutils literal notranslate"><span class="pre">retries</span></code><a class="headerlink" href="#id18" title="Link to this heading">¶</a></h5>
<p>An integer (default: 1) that specifies the default number of retries to use for submitting a job to the AWS Batch queue. This can be overridden on a per task basis using task options.</p>
</section>
<section id="id19">
<h5><code class="docutils literal notranslate"><span class="pre">job_name_prefix</span></code><a class="headerlink" href="#id19" title="Link to this heading">¶</a></h5>
<p>A string (default: <code class="docutils literal notranslate"><span class="pre">batch-job</span></code>) that specifies the prefix to use for AWS Batch job names. This can make it easier for users to distinguish which AWS Batch jobs correspond to their workflow.</p>
</section>
<section id="service-account-name">
<h5><code class="docutils literal notranslate"><span class="pre">service_account_name</span></code><a class="headerlink" href="#service-account-name" title="Link to this heading">¶</a></h5>
<p>A string (default: <code class="docutils literal notranslate"><span class="pre">default</span></code>) that specifices the k8s <a class="reference external" href="https://kubernetes.io/docs/reference/access-authn-authz/service-accounts-admin/">service account</a> to use.</p>
</section>
<section id="annotations">
<h5><code class="docutils literal notranslate"><span class="pre">annotations</span></code><a class="headerlink" href="#annotations" title="Link to this heading">¶</a></h5>
<p>An optional JSON object that specifies k8s annotations to apply to each job.</p>
</section>
<section id="k8s-labels">
<h5><code class="docutils literal notranslate"><span class="pre">k8s_labels</span></code><a class="headerlink" href="#k8s-labels" title="Link to this heading">¶</a></h5>
<p>An optional JSON object that specifies k8s labels to apply to each job.</p>
</section>
<section id="default-k8s-labels">
<h5><code class="docutils literal notranslate"><span class="pre">default_k8s_labels</span></code><a class="headerlink" href="#default-k8s-labels" title="Link to this heading">¶</a></h5>
<p>A bool (default: True) that specifies whether to add default k8s labels to jobs, such as <code class="docutils literal notranslate"><span class="pre">redun_job_id</span></code>, <code class="docutils literal notranslate"><span class="pre">redun_task_name</span></code>, etc.</p>
</section>
<section id="id20">
<h5><code class="docutils literal notranslate"><span class="pre">code_package</span></code><a class="headerlink" href="#id20" title="Link to this heading">¶</a></h5>
<p>A bool (default: True) that specifies whether to perform <a class="reference internal" href="executors.html#code-packaging"><span class="std std-ref">code packaging</span></a>.</p>
</section>
<section id="id21">
<h5><code class="docutils literal notranslate"><span class="pre">code_includes</span></code><a class="headerlink" href="#id21" title="Link to this heading">¶</a></h5>
<p>A string (default: <code class="docutils literal notranslate"><span class="pre">**/*.py</span></code>) that specifies a pattern for which files should be included in a <a class="reference internal" href="executors.html#code-packaging"><span class="std std-ref">code package</span></a>. Multiple patterns can be specified separated by whitespace. Whitespace can be escaped using <a class="reference external" href="https://docs.python.org/3/library/shlex.html#shlex.split">shell-like syntax</a></p>
</section>
<section id="id22">
<h5><code class="docutils literal notranslate"><span class="pre">code_excludes</span></code><a class="headerlink" href="#id22" title="Link to this heading">¶</a></h5>
<p>A string (default: None) that specifies a pattern for which files should be excluded from a <a class="reference internal" href="executors.html#code-packaging"><span class="std std-ref">code package</span></a>. Multiple patterns can be specified separated by whitespace. Whitespace can be escaped using <a class="reference external" href="https://docs.python.org/3/library/shlex.html#shlex.split">shell-like syntax</a></p>
</section>
<section id="id23">
<h5><code class="docutils literal notranslate"><span class="pre">job_monitor_interval</span></code><a class="headerlink" href="#id23" title="Link to this heading">¶</a></h5>
<p>A float (default: 5.0) that specifies how often, in seconds, the k8s API is queried to monitor running jobs.</p>
</section>
<section id="id24">
<h5><code class="docutils literal notranslate"><span class="pre">min_array_size</span></code><a class="headerlink" href="#id24" title="Link to this heading">¶</a></h5>
<p>Minimum number (default: 5) of equivalent tasks that will be submitted together as an <a class="reference external" href="https://kubernetes.io/docs/tasks/job/indexed-parallel-processing-static/">array job</a>. “Equivalent” means the same task and execution requirements (CPU, memory, etc), but with possibly different arguments. Set to 0 to disable array job submission.</p>
</section>
<section id="id25">
<h5><code class="docutils literal notranslate"><span class="pre">max_array_size</span></code><a class="headerlink" href="#id25" title="Link to this heading">¶</a></h5>
<p>Maximum number (default: 1000) of equivalent tasks that will be submitted together as an array job. Must be greater than or equal to <code class="docutils literal notranslate"><span class="pre">min_array_size</span></code>.</p>
</section>
<section id="id26">
<h5><code class="docutils literal notranslate"><span class="pre">job_stale_time</span></code><a class="headerlink" href="#id26" title="Link to this heading">¶</a></h5>
<p>A float (default: 3.0) that specifies the maximum time, in seconds, jobs will wait before submission to be possibly bundled into an array job.</p>
</section>
<section id="share-id">
<h5><code class="docutils literal notranslate"><span class="pre">share_id</span></code><a class="headerlink" href="#share-id" title="Link to this heading">¶</a></h5>
<p>Queues with Scheduling Policies require all jobs be assigned a Fair Share
Scheduling <code class="docutils literal notranslate"><span class="pre">shareIdentifier</span></code>. Can be further overridden on a per-task basis using task options.</p>
</section>
<section id="scheduling-priority-override">
<h5><code class="docutils literal notranslate"><span class="pre">scheduling_priority_override</span></code><a class="headerlink" href="#scheduling-priority-override" title="Link to this heading">¶</a></h5>
<p>Queues with Scheduling Policies require that all job definitions specify a <code class="docutils literal notranslate"><span class="pre">schedulingPriority</span></code>
Alternatively, if the batch job definition does <em>not</em> configure a <code class="docutils literal notranslate"><span class="pre">schedulingPriority</span></code>, you
must provide a <code class="docutils literal notranslate"><span class="pre">schedulingPriorityOverride</span></code> by setting this variable.
Can be further overridden on a per-task basis using task options.</p>
</section>
</section>
</section>
</section>
<section id="configuration-variables">
<h2>Configuration variables<a class="headerlink" href="#configuration-variables" title="Link to this heading">¶</a></h2>
<p>The redun configuration file supports <a class="reference external" href="https://docs.python.org/3/library/configparser.html#configparser.ExtendedInterpolation">variable interpolation</a>. When using the <code class="docutils literal notranslate"><span class="pre">${var}</span></code> variable reference syntax, redun will replace the variable reference with the value of the variable <code class="docutils literal notranslate"><span class="pre">var</span></code> from one of these sources (in descreasing precedence):</p>
<ul class="simple">
<li><p>variable in the same section.</p></li>
<li><p>variable in the <code class="docutils literal notranslate"><span class="pre">DEFAULT</span></code> section.</p></li>
<li><p>environment variable.</p></li>
</ul>
<p>For example, if one wanted to configure the AWS role used for an AWS Batch Job using an environment variable, <code class="docutils literal notranslate"><span class="pre">REDUN_ROLE</span></code>, it could be achieved with the following config file:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[executors.batch]</span>
<span class="na">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">aws_batch</span>
<span class="na">image</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">123.abc.ecr.us-west-2.amazonaws.com/amazonlinux-python3</span>
<span class="na">queue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">my-queue</span>
<span class="na">s3_scratch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">s3://bucket/redun/</span>
<span class="na">role</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">${REDUN_ROLE}</span>
</pre></div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="db.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Backend and database</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="scheduler.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Scheduling redun workflows</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, insitro
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Configuration</a><ul>
<li><a class="reference internal" href="#configuration-directory">Configuration directory</a></li>
<li><a class="reference internal" href="#configuration-options">Configuration options</a><ul>
<li><a class="reference internal" href="#scheduler">Scheduler</a><ul>
<li><a class="reference internal" href="#ignore-warnings"><code class="docutils literal notranslate"><span class="pre">ignore_warnings</span></code></a></li>
<li><a class="reference internal" href="#setup-scheduler"><code class="docutils literal notranslate"><span class="pre">setup_scheduler</span></code></a></li>
<li><a class="reference internal" href="#job-status-interval"><code class="docutils literal notranslate"><span class="pre">job_status_interval</span></code></a></li>
<li><a class="reference internal" href="#federated-configs"><code class="docutils literal notranslate"><span class="pre">federated_configs</span></code></a></li>
<li><a class="reference internal" href="#context"><code class="docutils literal notranslate"><span class="pre">context</span></code></a></li>
<li><a class="reference internal" href="#context-file"><code class="docutils literal notranslate"><span class="pre">context_file</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#backend">Backend</a><ul>
<li><a class="reference internal" href="#automigrate"><code class="docutils literal notranslate"><span class="pre">automigrate</span></code></a></li>
<li><a class="reference internal" href="#db-aws-secret-name"><code class="docutils literal notranslate"><span class="pre">db_aws_secret_name</span></code></a></li>
<li><a class="reference internal" href="#db-uri"><code class="docutils literal notranslate"><span class="pre">db_uri</span></code></a></li>
<li><a class="reference internal" href="#db-username-env"><code class="docutils literal notranslate"><span class="pre">db_username_env</span></code></a></li>
<li><a class="reference internal" href="#db-password-env"><code class="docutils literal notranslate"><span class="pre">db_password_env</span></code></a></li>
<li><a class="reference internal" href="#max-value-size"><code class="docutils literal notranslate"><span class="pre">max_value_size</span></code></a></li>
<li><a class="reference internal" href="#value-store-path"><code class="docutils literal notranslate"><span class="pre">value_store_path</span></code></a></li>
<li><a class="reference internal" href="#value-store-min-size"><code class="docutils literal notranslate"><span class="pre">value_store_min_size</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#limits">Limits</a></li>
<li><a class="reference internal" href="#executors">Executors</a><ul>
<li><a class="reference internal" href="#type"><code class="docutils literal notranslate"><span class="pre">type</span></code></a></li>
<li><a class="reference internal" href="#local-executor">Local executor</a><ul>
<li><a class="reference internal" href="#mode"><code class="docutils literal notranslate"><span class="pre">mode</span></code></a></li>
<li><a class="reference internal" href="#max-workers"><code class="docutils literal notranslate"><span class="pre">max_workers</span></code></a></li>
<li><a class="reference internal" href="#start-method"><code class="docutils literal notranslate"><span class="pre">start_method</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#alias-executor">Alias executor</a><ul>
<li><a class="reference internal" href="#target"><code class="docutils literal notranslate"><span class="pre">target</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#docker-executor">Docker executor</a><ul>
<li><a class="reference internal" href="#image"><code class="docutils literal notranslate"><span class="pre">image</span></code></a></li>
<li><a class="reference internal" href="#scratch"><code class="docutils literal notranslate"><span class="pre">scratch</span></code></a></li>
<li><a class="reference internal" href="#vcpus"><code class="docutils literal notranslate"><span class="pre">vcpus</span></code></a></li>
<li><a class="reference internal" href="#gpus"><code class="docutils literal notranslate"><span class="pre">gpus</span></code></a></li>
<li><a class="reference internal" href="#memory"><code class="docutils literal notranslate"><span class="pre">memory</span></code></a></li>
<li><a class="reference internal" href="#interactive"><code class="docutils literal notranslate"><span class="pre">interactive</span></code></a></li>
<li><a class="reference internal" href="#volumes"><code class="docutils literal notranslate"><span class="pre">volumes</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#aws-batch-executor">AWS Batch executor</a><ul>
<li><a class="reference internal" href="#id1"><code class="docutils literal notranslate"><span class="pre">image</span></code></a></li>
<li><a class="reference internal" href="#queue"><code class="docutils literal notranslate"><span class="pre">queue</span></code></a></li>
<li><a class="reference internal" href="#s3-scratch"><code class="docutils literal notranslate"><span class="pre">s3_scratch</span></code></a></li>
<li><a class="reference internal" href="#aws-region"><code class="docutils literal notranslate"><span class="pre">aws_region</span></code></a></li>
<li><a class="reference internal" href="#role"><code class="docutils literal notranslate"><span class="pre">role</span></code></a></li>
<li><a class="reference internal" href="#id2"><code class="docutils literal notranslate"><span class="pre">vcpus</span></code></a></li>
<li><a class="reference internal" href="#id3"><code class="docutils literal notranslate"><span class="pre">gpus</span></code></a></li>
<li><a class="reference internal" href="#id4"><code class="docutils literal notranslate"><span class="pre">memory</span></code></a></li>
<li><a class="reference internal" href="#retries"><code class="docutils literal notranslate"><span class="pre">retries</span></code></a></li>
<li><a class="reference internal" href="#job-name-prefix"><code class="docutils literal notranslate"><span class="pre">job_name_prefix</span></code></a></li>
<li><a class="reference internal" href="#code-package"><code class="docutils literal notranslate"><span class="pre">code_package</span></code></a></li>
<li><a class="reference internal" href="#code-includes"><code class="docutils literal notranslate"><span class="pre">code_includes</span></code></a></li>
<li><a class="reference internal" href="#code-excludes"><code class="docutils literal notranslate"><span class="pre">code_excludes</span></code></a></li>
<li><a class="reference internal" href="#debug"><code class="docutils literal notranslate"><span class="pre">debug</span></code></a></li>
<li><a class="reference internal" href="#job-monitor-interval"><code class="docutils literal notranslate"><span class="pre">job_monitor_interval</span></code></a></li>
<li><a class="reference internal" href="#min-array-size"><code class="docutils literal notranslate"><span class="pre">min_array_size</span></code></a></li>
<li><a class="reference internal" href="#max-array-size"><code class="docutils literal notranslate"><span class="pre">max_array_size</span></code></a></li>
<li><a class="reference internal" href="#job-stale-time"><code class="docutils literal notranslate"><span class="pre">job_stale_time</span></code></a></li>
<li><a class="reference internal" href="#timeout"><code class="docutils literal notranslate"><span class="pre">timeout</span></code></a></li>
<li><a class="reference internal" href="#privileged"><code class="docutils literal notranslate"><span class="pre">privileged</span></code></a></li>
<li><a class="reference internal" href="#autocreate-job-def"><code class="docutils literal notranslate"><span class="pre">autocreate_job_def</span></code></a></li>
<li><a class="reference internal" href="#job-def-name"><code class="docutils literal notranslate"><span class="pre">job_def_name</span></code></a></li>
<li><a class="reference internal" href="#batch-tags"><code class="docutils literal notranslate"><span class="pre">batch_tags</span></code></a></li>
<li><a class="reference internal" href="#default-batch-tags"><code class="docutils literal notranslate"><span class="pre">default_batch_tags</span></code></a></li>
<li><a class="reference internal" href="#num-nodes"><code class="docutils literal notranslate"><span class="pre">num_nodes</span></code></a></li>
<li><a class="reference internal" href="#job-def-extra"><code class="docutils literal notranslate"><span class="pre">job_def_extra</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#aws-glue-executor">AWS Glue executor</a><ul>
<li><a class="reference internal" href="#id5"><code class="docutils literal notranslate"><span class="pre">s3_scratch</span></code></a></li>
<li><a class="reference internal" href="#workers"><code class="docutils literal notranslate"><span class="pre">workers</span></code></a></li>
<li><a class="reference internal" href="#worker-type"><code class="docutils literal notranslate"><span class="pre">worker_type</span></code></a></li>
<li><a class="reference internal" href="#id6"><code class="docutils literal notranslate"><span class="pre">aws_region</span></code></a></li>
<li><a class="reference internal" href="#id7"><code class="docutils literal notranslate"><span class="pre">role</span></code></a></li>
<li><a class="reference internal" href="#glue-job-prefix"><code class="docutils literal notranslate"><span class="pre">glue_job_prefix</span></code></a></li>
<li><a class="reference internal" href="#spark-history-dir"><code class="docutils literal notranslate"><span class="pre">spark_history_dir</span></code></a></li>
<li><a class="reference internal" href="#id8"><code class="docutils literal notranslate"><span class="pre">job_monitor_interval</span></code></a></li>
<li><a class="reference internal" href="#job-retry-interval"><code class="docutils literal notranslate"><span class="pre">job_retry_interval</span></code></a></li>
<li><a class="reference internal" href="#id9"><code class="docutils literal notranslate"><span class="pre">timeout</span></code></a></li>
<li><a class="reference internal" href="#id10"><code class="docutils literal notranslate"><span class="pre">code_package</span></code></a></li>
<li><a class="reference internal" href="#id11"><code class="docutils literal notranslate"><span class="pre">code_includes</span></code></a></li>
<li><a class="reference internal" href="#id12"><code class="docutils literal notranslate"><span class="pre">code_excludes</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#federated-tasks">Federated tasks</a><ul>
<li><a class="reference internal" href="#namespace"><code class="docutils literal notranslate"><span class="pre">namespace</span></code></a></li>
<li><a class="reference internal" href="#task-name"><code class="docutils literal notranslate"><span class="pre">task_name</span></code></a></li>
<li><a class="reference internal" href="#load-module"><code class="docutils literal notranslate"><span class="pre">load_module</span></code></a></li>
<li><a class="reference internal" href="#executor"><code class="docutils literal notranslate"><span class="pre">executor</span></code></a></li>
<li><a class="reference internal" href="#config-dir"><code class="docutils literal notranslate"><span class="pre">config_dir</span></code></a></li>
<li><a class="reference internal" href="#task-signature"><code class="docutils literal notranslate"><span class="pre">task_signature</span></code></a></li>
<li><a class="reference internal" href="#description"><code class="docutils literal notranslate"><span class="pre">description</span></code></a></li>
<li><a class="reference internal" href="#kubernetes-k8s-executor">Kubernetes (k8s) executor</a><ul>
<li><a class="reference internal" href="#id13"><code class="docutils literal notranslate"><span class="pre">image</span></code></a></li>
<li><a class="reference internal" href="#id14"><code class="docutils literal notranslate"><span class="pre">scratch</span></code></a></li>
<li><a class="reference internal" href="#id15"><code class="docutils literal notranslate"><span class="pre">namespace</span></code></a></li>
<li><a class="reference internal" href="#secret-name"><code class="docutils literal notranslate"><span class="pre">secret_name</span></code></a></li>
<li><a class="reference internal" href="#import-aws-secrets"><code class="docutils literal notranslate"><span class="pre">import_aws_secrets</span></code></a></li>
<li><a class="reference internal" href="#secret-env-vars"><code class="docutils literal notranslate"><span class="pre">secret_env_vars</span></code></a></li>
<li><a class="reference internal" href="#id16"><code class="docutils literal notranslate"><span class="pre">vcpus</span></code></a></li>
<li><a class="reference internal" href="#id17"><code class="docutils literal notranslate"><span class="pre">memory</span></code></a></li>
<li><a class="reference internal" href="#id18"><code class="docutils literal notranslate"><span class="pre">retries</span></code></a></li>
<li><a class="reference internal" href="#id19"><code class="docutils literal notranslate"><span class="pre">job_name_prefix</span></code></a></li>
<li><a class="reference internal" href="#service-account-name"><code class="docutils literal notranslate"><span class="pre">service_account_name</span></code></a></li>
<li><a class="reference internal" href="#annotations"><code class="docutils literal notranslate"><span class="pre">annotations</span></code></a></li>
<li><a class="reference internal" href="#k8s-labels"><code class="docutils literal notranslate"><span class="pre">k8s_labels</span></code></a></li>
<li><a class="reference internal" href="#default-k8s-labels"><code class="docutils literal notranslate"><span class="pre">default_k8s_labels</span></code></a></li>
<li><a class="reference internal" href="#id20"><code class="docutils literal notranslate"><span class="pre">code_package</span></code></a></li>
<li><a class="reference internal" href="#id21"><code class="docutils literal notranslate"><span class="pre">code_includes</span></code></a></li>
<li><a class="reference internal" href="#id22"><code class="docutils literal notranslate"><span class="pre">code_excludes</span></code></a></li>
<li><a class="reference internal" href="#id23"><code class="docutils literal notranslate"><span class="pre">job_monitor_interval</span></code></a></li>
<li><a class="reference internal" href="#id24"><code class="docutils literal notranslate"><span class="pre">min_array_size</span></code></a></li>
<li><a class="reference internal" href="#id25"><code class="docutils literal notranslate"><span class="pre">max_array_size</span></code></a></li>
<li><a class="reference internal" href="#id26"><code class="docutils literal notranslate"><span class="pre">job_stale_time</span></code></a></li>
<li><a class="reference internal" href="#share-id"><code class="docutils literal notranslate"><span class="pre">share_id</span></code></a></li>
<li><a class="reference internal" href="#scheduling-priority-override"><code class="docutils literal notranslate"><span class="pre">scheduling_priority_override</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#configuration-variables">Configuration variables</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=4e2eecee"></script>
    </body>
</html>